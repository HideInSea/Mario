{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\posMgr.js"],"names":["require","MoveCmd","cc","Class","extends","Component","properties","init","posLayer","gm","mapMgr","posObjects","getObjects","startObj","getObject","endObj","startPos","objectPosToMapPos","v2","x","y","endPos","currPlayer","setPosition","config","mapConfig","startType","global","getRound","playerScript","enableInput","aiCtrl","addCmd","macro","KEY","d","mapFixeds","i","length","name","ENUM","POSITION_TYPE","MAP_FIXED","push","splice","update","dt","isGameOver","active","EM","emit","type","PLAYER_TO_END","mapFixed","setMapToPos","pos","node","paseTile","tilePosToPos","toTiledPos","hPipeEntry","args","split","desObj","mapPos","desPos","desMapPos","parseInt","moveLeft","moveTo","PIPE_POS_TYPE","LAND","runAction","sequence","callFunc","landCallBack","AIR","airCallBack","vPipeEntry","moveDown","moveBy","ROUND","selectRound","log","target","data","fadeOut","fadeIn","delay","delayTime","fsm","switchState","isPause","enableMapMove","worldPos","convertToWorldSpace"],"mappings":"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","file":"posMgr.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\nvar {MoveCmd}=require(\"aiCtrl\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n    },\r\n    init(){\r\n        this.posLayer=gm.mapMgr.posLayer;\r\n        this.posObjects=this.posLayer.getObjects();\r\n        let startObj=this.posLayer.getObject(\"start\");\r\n        let endObj=this.posLayer.getObject(\"end\");\r\n        let startPos=this.objectPosToMapPos(cc.v2(startObj.x,startObj.y));\r\n        let endPos=null;\r\n        if(endObj){\r\n            endPos=this.objectPosToMapPos(cc.v2(endObj.x,endObj.y));\r\n            this.endPos=cc.v2(endPos.x+20,endPos.y);\r\n        }\r\n        this.startPos=cc.v2(startPos.x+20,startPos.y);\r\n\r\n        gm.currPlayer.setPosition(this.startPos);\r\n        if(config.mapConfig.startType[global.getRound()]){\r\n            gm.playerScript.enableInput=false;\r\n            gm.playerScript.aiCtrl.addCmd(new MoveCmd(gm.playerScript,cc.macro.KEY.d,\"keydown\"));\r\n        }\r\n        //地图固定点\r\n        this.mapFixeds=[];\r\n        for(let i=0;i<this.posObjects.length;i++){\r\n            if(this.posObjects[i].name===ENUM.POSITION_TYPE.MAP_FIXED){\r\n                this.mapFixeds.push(this.posObjects.splice(i,1)[0]);\r\n                i--;\r\n            }\r\n        }\r\n    },\r\n    update (dt) {\r\n        //检测玩家是否走到终点\r\n        if(this.endPos&&gm.currPlayer.x>=this.endPos.x&&!global.isGameOver){\r\n            gm.currPlayer.active=false;\r\n            global.isGameOver=true;\r\n            EM.emit(EM.type.PLAYER_TO_END);\r\n        }\r\n\r\n        //检测地图固定点\r\n        this.mapFixed();\r\n    },\r\n    setMapToPos(pos){\r\n        gm.node.setPosition(pos);\r\n        gm.mapMgr.paseTile(true);\r\n    },\r\n    objectPosToMapPos(pos){\r\n        return gm.mapMgr.tilePosToPos(gm.mapMgr.toTiledPos(pos));\r\n    },\r\n    hPipeEntry(type,pos){\r\n        let args=type.split(\"_\");\r\n        let desObj=this.posLayer.getObject(\"pipeEnd_\"+args[2]);\r\n        let mapPos=this.objectPosToMapPos(cc.v2(desObj.x,desObj.y));\r\n        //let screenPos=gm.mapMgr.mapPosToScreenPos(mapPos);\r\n        let desPos=cc.v2(mapPos.x+40,mapPos.y);\r\n        let desMapPos=cc.v2(-desPos.x+40*parseInt(args[3])-320,gm.node.y);\r\n        let moveLeft=cc.moveTo(1,pos);\r\n\r\n        switch(args[1]){\r\n            case ENUM.PIPE_POS_TYPE.LAND:\r\n                gm.currPlayer.runAction(cc.sequence(moveLeft,cc.callFunc(this.landCallBack,this,{desPos:desPos,desMapPos:desMapPos})));\r\n            break;\r\n            case ENUM.PIPE_POS_TYPE.AIR:\r\n                gm.currPlayer.runAction(cc.sequence(moveLeft,cc.callFunc(this.airCallBack,this,{desPos:desPos,desMapPos:desMapPos})));\r\n            break;\r\n        }\r\n    },\r\n    vPipeEntry(type,pos){\r\n        let args=type.split(\"_\");\r\n        let moveDown=cc.moveBy(1,cc.v2(0,-80));\r\n\r\n        if(args[0]===ENUM.POSITION_TYPE.ROUND){\r\n            gm.currPlayer.runAction(cc.sequence(moveDown,cc.callFunc(this.selectRound,this)));\r\n            return;\r\n        }\r\n\r\n        let desObj=this.posLayer.getObject(\"pipeEnd_\"+args[2]);\r\n        let mapPos=this.objectPosToMapPos(cc.v2(desObj.x,desObj.y));\r\n        //let screenPos=gm.mapMgr.mapPosToScreenPos(mapPos);\r\n        let desPos=cc.v2(mapPos.x+40,mapPos.y);\r\n        let desMapPos=cc.v2(-desPos.x+40*parseInt(args[3])-320,gm.node.y);\r\n\r\n        switch(args[1]){\r\n            case ENUM.PIPE_POS_TYPE.LAND:\r\n                gm.currPlayer.runAction(cc.sequence(moveDown,cc.callFunc(this.landCallBack,this,{desPos:desPos,desMapPos:desMapPos})));\r\n            break;\r\n            case ENUM.PIPE_POS_TYPE.AIR:\r\n                gm.currPlayer.runAction(cc.sequence(moveDown,cc.callFunc(this.airCallBack,this,{desPos:desPos,desMapPos:desMapPos})));\r\n            break;\r\n        }\r\n    },  \r\n    selectRound(){\r\n        cc.log(\"next\");\r\n    },\r\n    landCallBack(target,data){\r\n        let fadeOut=cc.fadeOut(0.05);\r\n        let fadeIn=cc.fadeIn(0.05);\r\n        let delay=cc.delayTime(0.2);\r\n        gm.node.runAction(cc.sequence(fadeOut,cc.callFunc(function(target,data){\r\n            gm.currPlayer.setPosition(cc.v2(data.desPos.x,data.desPos.y));\r\n            this.setMapToPos(data.desMapPos);\r\n            gm.playerScript.fsm.switchState(\"stand\");\r\n        },this,data),delay,fadeIn,cc.callFunc(function(){\r\n            gm.currPlayer.runAction(cc.sequence(cc.moveBy(1,cc.v2(0,80)),cc.callFunc(function(){\r\n                gm.playerScript.isPause=false;\r\n                gm.playerScript.enableInput=true;\r\n                gm.enableMapMove=true;\r\n            },this)));\r\n        },this)));\r\n    },\r\n    airCallBack(target,data){\r\n        let fadeOut=cc.fadeOut(0.05);\r\n        let fadeIn=cc.fadeIn(0.05);\r\n        let delay=cc.delayTime(0.5);\r\n        gm.node.runAction(cc.sequence(fadeOut,cc.callFunc(function(target,data){\r\n            gm.currPlayer.setPosition(data.desPos);\r\n            this.setMapToPos(data.desMapPos);\r\n            gm.playerScript.fsm.switchState(\"stand\");\r\n        },this,data),delay,fadeIn,cc.callFunc(function(){\r\n            gm.playerScript.isPause=false;\r\n            gm.playerScript.enableInput=true;\r\n            gm.enableMapMove=true;\r\n        },this)));\r\n    },\r\n    mapFixed(){\r\n        if(!gm.enableMapMove)return;\r\n        for(let i=0;i<this.mapFixeds.length;i++){\r\n            //cc.log(this.mapFixeds[i]);\r\n            let pos=this.objectPosToMapPos(cc.v2(this.mapFixeds[i].x,this.mapFixeds[i].y));\r\n            let worldPos=gm.node.convertToWorldSpace(cc.v2(pos.x+40,pos.y));\r\n            if(worldPos.x>0&&worldPos.x<=640){\r\n                gm.node.x+=640-worldPos.x;\r\n                gm.enableMapMove=false;\r\n                return;\r\n            }\r\n        }\r\n    }\r\n});\r\n"]}