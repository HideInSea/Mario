{"version":3,"sources":["bullet.js"],"names":["Actor","require","cc","Class","extends","properties","init","dir","hDefSpe","vDefAcce","vDefSpe","vMaxSpeed","animation","node","getComponent","Animation","play","vCurrSpeed","vCurrAcceleration","isPause","hCurrSpeed","getHSpeed","isDie","getSize","size","getContentSize","height","width","rect","x","y","dieCallBack","removeFromParent","update","dt","backPos","move","tile","getDownCollsiTile","type","TILE_TYPE","LAND","PIPE_H_ENTRY","WALL","PIPE_V_ENTRY","QUESTION","collsiDown","jump","getRightCollsiTile","die","FLAG","getLeftCollsiTile","isOutScreen","oldPos","DIR","DIR_LEFT","pause","resume","resuem"],"mappings":"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","file":"bullet.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\weapon","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\nvar Actor=require(\"actor\");\r\ncc.Class({\r\n    extends:Actor,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    init(dir){ \r\n         this.dir=dir;   \r\n         this.hDefSpe=600;\r\n         this.vDefAcce=-6000;\r\n         this.vDefSpe=600;\r\n         this.vMaxSpeed=600;\r\n         this.animation=this.node.getComponent(cc.Animation);\r\n         this.animation.play(\"bullet_roll\");\r\n         this.vCurrSpeed=-600;\r\n         this.vCurrAcceleration=this.vDefAcce;\r\n         this.isPause=false;\r\n         this.hCurrSpeed=this.getHSpeed();\r\n         this.isDie=false;\r\n    },\r\n    getSize(){\r\n        let size=this.node.getContentSize();\r\n        let height=size.height;\r\n        let width=size.width;\r\n        return cc.rect(this.node.x,this.node.y,width,height);\r\n    },\r\n    dieCallBack(){\r\n        this.node.removeFromParent();\r\n    },\r\n    update (dt) {\r\n        if(this.isPause)return;\r\n        this.backPos();\r\n\r\n        this.move(dt);\r\n\r\n        //限制垂直方向下的速度\r\n        if(this.vCurrSpeed<-this.vMaxSpeed){\r\n            this.vCurrSpeed=-this.vMaxSpeed;\r\n        }\r\n\r\n        let tile=null;\r\n        //脚底的碰撞检测\r\n        tile=this.getDownCollsiTile();\r\n        if(tile.type){\r\n            switch(tile.type){\r\n                case TILE_TYPE.LAND:\r\n                case TILE_TYPE.PIPE_H_ENTRY:\r\n                case TILE_TYPE.WALL:\r\n                case TILE_TYPE.PIPE_V_ENTRY:  \r\n                case TILE_TYPE.QUESTION:\r\n                    this.collsiDown(tile.tile);\r\n                    this.jump();\r\n                break;                    \r\n            }\r\n        }\r\n\r\n        tile=this.getRightCollsiTile();\r\n        if(tile.type){\r\n            switch(tile.type){\r\n                case TILE_TYPE.LAND:\r\n                case TILE_TYPE.PIPE_H_ENTRY:\r\n                case TILE_TYPE.WALL:\r\n                case TILE_TYPE.PIPE_V_ENTRY:  \r\n                case TILE_TYPE.QUESTION:\r\n                    this.die();\r\n                break;\r\n                case TILE_TYPE.FLAG:\r\n                    this.node.x=tile.tile.node.x+15;\r\n                    this.die();\r\n                break;                    \r\n            } \r\n        }\r\n\r\n\r\n        tile=this.getLeftCollsiTile();\r\n        if(tile.type){\r\n            switch(tile.type){\r\n                case TILE_TYPE.LAND:\r\n                case TILE_TYPE.PIPE_H_ENTRY:\r\n                case TILE_TYPE.WALL:\r\n                case TILE_TYPE.PIPE_V_ENTRY:  \r\n                case TILE_TYPE.QUESTION:\r\n                    this.die();\r\n                break;   \r\n                case TILE_TYPE.FLAG:\r\n                    this.node.x=tile.tile.node.x+15;\r\n                    this.die();\r\n                break;                  \r\n            }\r\n        }\r\n\r\n        if(this.isOutScreen()){\r\n            this.node.removeFromParent();\r\n        }\r\n\r\n    },\r\n    collsiDown(tile){\r\n        let size=this.getSize();\r\n        if((this.oldPos.y>=tile.node.y)\r\n        &&((this.oldPos.x-size.width/2>=tile.node.x&&this.oldPos.x-size.width/2<=tile.node.x+40)\r\n        ||(this.oldPos.x+size.width/2>=tile.node.x&&this.oldPos.x+size.width/2<=tile.node.x+40))){\r\n            this.node.y=tile.node.y+40;\r\n            this.jump();\r\n        }\r\n    },\r\n    die(){\r\n        this.isPause=true;\r\n        this.isDie=true;\r\n        this.animation.play(\"bullet\");\r\n    },\r\n    getHSpeed(){\r\n        return this.dir===DIR.DIR_LEFT?-this.hDefSpe:this.hDefSpe;\r\n    },\r\n    jump(){\r\n        this.vCurrSpeed=this.vDefSpe;\r\n        this.vCurrAcceleration=this.vDefAcce;\r\n    },\r\n    pause(){\r\n        this.isPause=true;\r\n        this.animation.pause();\r\n    },\r\n    resume(){   \r\n        this.isPause=false;\r\n        this.animation.resuem();\r\n    }\r\n});\r\n"]}