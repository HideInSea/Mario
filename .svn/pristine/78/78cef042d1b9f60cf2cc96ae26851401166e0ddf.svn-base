{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\prop/assets\\script\\prop\\story.js"],"names":["Actor","require","cc","Class","extends","properties","init","type","arguments","ENUM","STORY_TYPE","SKY","desObj","gm","posMgr","posLayer","getObject","mapPos","objectPosToMapPos","v2","x","y","desPos","desMapPos","parseInt","node","getSize","rect","interactive","actor","EM","emit","SHOW_SELECT_ZOOM","REMOVE_ALL_MON","removeFromParent","airCallBack","update","dt","isOutScreen"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAIA,QAAMC,QAAQ,OAAR,CAAV;AACAC,GAAGC,KAAH,CAAS;AACLC,aAAQJ,KADH;;AAGLK,gBAAY;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfQ,KAHP;;AAqBL;AACAC,QAtBK,kBAsBC;AACF,aAAKC,IAAL,GAAUC,UAAU,CAAV,CAAV;AACA,YAAG,KAAKD,IAAL,KAAYE,KAAKC,UAAL,CAAgBC,GAA/B,EAAmC;AAC/B,gBAAIC,SAAOC,GAAGC,MAAH,CAAUC,QAAV,CAAmBC,SAAnB,CAA6B,YAAUR,UAAU,CAAV,CAAvC,CAAX;AACA,gBAAIS,SAAOJ,GAAGC,MAAH,CAAUI,iBAAV,CAA4BhB,GAAGiB,EAAH,CAAMP,OAAOQ,CAAb,EAAeR,OAAOS,CAAtB,CAA5B,CAAX;AACA;AACA,iBAAKC,MAAL,GAAYpB,GAAGiB,EAAH,CAAMF,OAAOG,CAAP,GAAS,EAAf,EAAkBH,OAAOI,CAAP,GAAS,EAA3B,CAAZ;AACA,iBAAKE,SAAL,GAAerB,GAAGiB,EAAH,CAAM,CAACF,OAAOG,CAAR,GAAU,KAAGI,SAAShB,UAAU,CAAV,CAAT,CAAb,GAAoC,GAA1C,EAA8CK,GAAGY,IAAH,CAAQJ,CAAtD,CAAf;AACH;AACJ,KA/BI;AAgCLK,WAhCK,qBAgCI;AACL,eAAOxB,GAAGyB,IAAH,CAAQ,CAAR,EAAU,CAAV,EAAY,CAAZ,EAAc,CAAd,CAAP;AACH,KAlCI;AAmCLC,eAnCK,uBAmCOC,KAnCP,EAmCa;AACd,YAAGA,MAAMJ,IAAN,CAAWJ,CAAX,GAAa,KAAKI,IAAL,CAAUJ,CAA1B,EAA4B;AAC5B,gBAAO,KAAKd,IAAZ;AACI,iBAAKE,KAAKC,UAAL,CAAgB,OAAhB,CAAL;AACA,iBAAKD,KAAKC,UAAL,CAAgB,OAAhB,CAAL;AACA,iBAAKD,KAAKC,UAAL,CAAgB,GAAhB,CAAL;AACIoB,mBAAGC,IAAH,CAAQD,GAAGvB,IAAH,CAAQyB,gBAAhB,EAAiC,KAAKzB,IAAtC;AACAuB,mBAAGC,IAAH,CAAQD,GAAGvB,IAAH,CAAQ0B,cAAhB;AACA,qBAAKR,IAAL,CAAUS,gBAAV;AACJ;AACA,iBAAKzB,KAAKC,UAAL,CAAgBC,GAArB;AACIE,mBAAGC,MAAH,CAAUqB,WAAV,CAAsB,IAAtB,EAA2B,EAACZ,WAAU,KAAKA,SAAhB,EAA0BD,QAAO,KAAKA,MAAtC,EAA3B;AACA,qBAAKG,IAAL,CAAUS,gBAAV;AACJ;AAXJ;AAaH,KAlDI;;AAmDL;AACAE,UApDK,kBAoDGC,EApDH,EAoDO;AACR,YAAG,KAAKC,WAAL,EAAH,EAAsB;AAClB,iBAAKJ,gBAAL;AACH;AACJ;AAxDI,CAAT","file":"story.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\prop","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\nvar Actor=require(\"actor\");\r\ncc.Class({\r\n    extends:Actor,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    init(){\r\n        this.type=arguments[1];\r\n        if(this.type===ENUM.STORY_TYPE.SKY){\r\n            let desObj=gm.posMgr.posLayer.getObject(\"skyEnd_\"+arguments[2]);\r\n            let mapPos=gm.posMgr.objectPosToMapPos(cc.v2(desObj.x,desObj.y));\r\n            //let screenPos=gm.mapMgr.mapPosToScreenPos(mapPos);\r\n            this.desPos=cc.v2(mapPos.x+20,mapPos.y-80);\r\n            this.desMapPos=cc.v2(-mapPos.x+40*parseInt(arguments[3])-320,gm.node.y);\r\n        }\r\n    },\r\n    getSize(){\r\n        return cc.rect(0,0,0,0);\r\n    },  \r\n    interactive(actor){\r\n        if(actor.node.y>this.node.y)return;\r\n        switch(this.type){\r\n            case ENUM.STORY_TYPE[\"2_3_4\"]:\r\n            case ENUM.STORY_TYPE[\"6_7_8\"]:\r\n            case ENUM.STORY_TYPE[\"5\"]:\r\n                EM.emit(EM.type.SHOW_SELECT_ZOOM,this.type);\r\n                EM.emit(EM.type.REMOVE_ALL_MON);\r\n                this.node.removeFromParent();\r\n            break;\r\n            case ENUM.STORY_TYPE.SKY:\r\n                gm.posMgr.airCallBack(null,{desMapPos:this.desMapPos,desPos:this.desPos});\r\n                this.node.removeFromParent();\r\n            break;\r\n        }\r\n    },\r\n    //onLoad () {}\r\n    update (dt) {\r\n        if(this.isOutScreen()){\r\n            this.removeFromParent();\r\n        }\r\n    }\r\n});\r\n"]}