{"version":3,"sources":["mflower.js"],"names":["Actor","require","cc","Class","extends","properties","init","orignPos","node","position","actorType","arguments","color","isMoving","animation","getComponent","Animation","play","isPlayerAround","delay","delayTime","moveDown","moveBy","v2","moveUp","runAction","repeatForever","sequence","callFunc","clone","getSize","width","heigth","rect","x","y","interactive","actor","isDie","sizeOne","sizeTwo","actorCollsition","isFlashing","die","isInvincible","getFormState","FORM_STATE","SMALL","fsm","switchStateWithStack","switchState","pause","resume","update","dt","isOutScreen","removeFromParent","pauseAllActions","resumeAllActions","EM","emit","type","SCORE_EFFECT","onCollsiWithPBullet","bullet"],"mappings":"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","file":"mflower.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\monster","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\nvar Actor=require(\"actor\");\r\ncc.Class({\r\n    extends:Actor,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n        \r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    init(){\r\n        this.orignPos=this.node.position;\r\n        this.actorType=arguments[0];\r\n        this.color=arguments[1];\r\n        this.isMoving=false;\r\n        this.animation=this.node.getComponent(cc.Animation);\r\n        this.animation.play(this.color);\r\n        this.isPlayerAround=false;\r\n        let delay=cc.delayTime(1);\r\n        let moveDown=cc.moveBy(2,cc.v2(0,-80));\r\n        let moveUp=cc.moveBy(2,cc.v2(0,80));\r\n        this.node.runAction(cc.repeatForever(cc.sequence(delay,cc.callFunc(()=>{\r\n            this.isMoving=true;\r\n        }),moveUp,delay.clone(),moveDown,cc.callFunc(()=>{\r\n            this.isMoving=false;\r\n        }),delay.clone())));\r\n    },\r\n    // onLoad () {},\r\n    getSize() {\r\n        let width=34;\r\n        let heigth=34;\r\n        return cc.rect(this.node.x,this.node.y,width,heigth);\r\n    },\r\n    interactive(actor){\r\n        if(actor.isDie)return;\r\n        let sizeOne=actor.getSize();\r\n        let sizeTwo=this.getSize();\r\n        if(this.actorCollsition(sizeOne,sizeTwo)&&this.node.y>this.orignPos.y+20){\r\n            //闪烁状态碰到怪物\r\n            if(actor.isFlashing){\r\n                this.die();\r\n            }\r\n            //无敌状态碰到怪物\r\n            else if(actor.isInvincible){\r\n            }\r\n            //普通状态碰到蘑菇\r\n            else{\r\n                if(actor.getFormState()!==FORM_STATE.SMALL){\r\n                    actor.fsm.switchStateWithStack(\"to_small\");\r\n                }else{\r\n                    actor.fsm.switchState(\"die\");\r\n                }\r\n            }\r\n        }else if(sizeOne.x<this.orignPos.x+80&&sizeOne.x>this.orignPos.x-80&&sizeOne.y<this.orignPos.y+120){\r\n            if(!this.isMoving&&!this.isPlayerAround){\r\n                this.isPlayerAround=true;\r\n                this.pause();\r\n            }\r\n        }else if(this.isPlayerAround){\r\n            this.isPlayerAround=false;\r\n            this.resume();\r\n        }\r\n    },\r\n    update (dt) {\r\n        if(this.isOutScreen()){\r\n            this.node.removeFromParent();\r\n        }\r\n    },\r\n    pause(){\r\n        this.node.pauseAllActions();\r\n        this.animation.pause();\r\n    },\r\n    resume(){\r\n        this.node.resumeAllActions();\r\n        this.animation.resume();\r\n    },\r\n    die(){\r\n        this.node.removeFromParent();\r\n        EM.emit(EM.type.SCORE_EFFECT,cc.v2(this.node.x,this.node.y+80),200);\r\n    },\r\n    onCollsiWithPBullet(bullet){\r\n        bullet.die();\r\n        this.die();\r\n    }\r\n});\r\n"]}