{"version":3,"sources":["star.js"],"names":["Actor","require","cc","Class","extends","properties","init","hDefaultSpe","vDefAcce","vDefSpe","isPause","hCurrSpeed","vCurrAcceleration","vCurrSpeed","dir","DIR","DIR_RIGHT","playBorthAni","animation","node","getComponent","Animation","moveUp","moveBy","v2","runAction","sequence","callFunc","interactive","actor","sizeOne","getSize","sizeTwo","rectOne","rect","x","width","y","height","rectTwo","Intersection","rectRect","fsm","switchSubState","removeFromParent","size","getContentSize","update","dt","backPos","move","tile","getDownCollsiTile","type","TILE_TYPE","LAND","PIPE_H_ENTRY","WALL","PIPE_V_ENTRY","QUESTION","collsiDown","getRightCollsiTile","collsiRight","getLeftCollsiTile","collsiLeft","isOutScreen","turnRight","turnLeft","oldPos","jump","DIR_LEFT","pause","resume"],"mappings":"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","file":"star.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\prop","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\nvar Actor=require(\"actor\");\r\ncc.Class({\r\n    extends: Actor,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n    init(){\r\n        this.hDefaultSpe=180;\r\n        this.vDefAcce=-1500;\r\n        this.vDefSpe=500;\r\n        this.isPause=true;           //禁止碰撞检测\r\n        this.hCurrSpeed=this.hDefaultSpe;\r\n        this.vCurrAcceleration=this.vDefAcce;\r\n        this.vCurrSpeed=this.vDefSpe;\r\n        this.dir=DIR.DIR_RIGHT;  \r\n        this.playBorthAni(); \r\n        this.animation=this.node.getComponent(cc.Animation);\r\n    },\r\n    //出场动画\r\n    playBorthAni(){\r\n        let moveUp=cc.moveBy(0.6,cc.v2(0,40));\r\n        this.node.runAction(cc.sequence(moveUp,cc.callFunc(function(){\r\n            this.isPause=false;\r\n        },this)));\r\n    },\r\n    interactive(actor){\r\n        let sizeOne=actor.getSize();\r\n        let sizeTwo=this.getSize();\r\n        let rectOne=cc.rect(sizeOne.x-sizeOne.width/2,sizeOne.y,sizeOne.width,sizeOne.height);\r\n        let rectTwo=cc.rect(sizeTwo.x-sizeTwo.width/2,sizeTwo.y,sizeTwo.width,sizeTwo.height);\r\n        if(cc.Intersection.rectRect(rectOne,rectTwo)){\r\n            actor.fsm.switchSubState(\"flash_catch_star\");\r\n            this.node.removeFromParent();\r\n        }\r\n    },\r\n    getSize(){\r\n        let size=this.node.getContentSize();\r\n        let height=size.height;\r\n        let width=size.width;\r\n        return cc.rect(this.node.x,this.node.y,width,height);\r\n    },\r\n    update (dt) {\r\n        if(this.isPause)return;\r\n\r\n        this.backPos();\r\n\r\n        this.move(dt);\r\n\r\n        let tile=null;\r\n\r\n        //脚底的碰撞检测\r\n        tile=this.getDownCollsiTile();\r\n        if(tile.type){\r\n            switch(tile.type){\r\n                case TILE_TYPE.LAND:\r\n                case TILE_TYPE.PIPE_H_ENTRY:\r\n                case TILE_TYPE.WALL:\r\n                case TILE_TYPE.PIPE_V_ENTRY:  \r\n                case TILE_TYPE.QUESTION:\r\n                    this.collsiDown(tile.tile);\r\n                break;                    \r\n            }\r\n        }\r\n\r\n        tile=this.getRightCollsiTile();\r\n        if(tile.type){\r\n            switch(tile.type){\r\n                case TILE_TYPE.LAND:\r\n                case TILE_TYPE.PIPE_H_ENTRY:\r\n                case TILE_TYPE.PIPE_V_ENTRY:  \r\n                    this.collsiRight(tile.tile);\r\n                break;                    \r\n            }\r\n        }\r\n\r\n\r\n        tile=this.getLeftCollsiTile();\r\n        if(tile.type){\r\n            switch(tile.type){\r\n                case TILE_TYPE.LAND:\r\n                case TILE_TYPE.PIPE_H_ENTRY:\r\n                case TILE_TYPE.PIPE_V_ENTRY:  \r\n                    this.collsiLeft(tile.tile);\r\n                break;                    \r\n            }\r\n        }\r\n\r\n        if(this.isOutScreen()){\r\n            this.node.removeFromParent();\r\n        }\r\n\r\n    },\r\n    collsiLeft(tile){\r\n        this.turnRight();\r\n        this.node.x=this.getSize().width/2+tile.node.x+40+1;\r\n    },\r\n    collsiRight(tile){\r\n        this.turnLeft();\r\n        this.node.x=tile.node.x-this.getSize().width/2-1;\r\n    },\r\n    collsiDown(tile){\r\n        let size=this.getSize();\r\n        if((this.oldPos.y>=tile.node.y)\r\n        &&((this.oldPos.x-size.width/2>=tile.node.x&&this.oldPos.x-size.width/2<=tile.node.x+40)\r\n        ||(this.oldPos.x+size.width/2>=tile.node.x&&this.oldPos.x+size.width/2<=tile.node.x+40))){\r\n            this.node.y=tile.node.y+40;\r\n            this.jump();\r\n        }\r\n    },\r\n    turnRight(){\r\n        this.dir=DIR.DIR_RIGHT;\r\n        this.hCurrSpeed=this.hDefaultSpe;\r\n    },\r\n    turnLeft(){\r\n        this.dir=DIR.DIR_LEFT;\r\n        this.hCurrSpeed=-this.hDefaultSpe;\r\n    },\r\n    jump(){\r\n        this.vCurrAcceleration=this.vDefAcce;\r\n        this.vCurrSpeed=this.vDefSpe;\r\n    },\r\n    pause(){\r\n        this.isPause=true;\r\n        this.animation.pause();\r\n    },\r\n    resume(){   \r\n        this.isPause=false;\r\n        this.animation.resume();\r\n    }\r\n});\r\n"]}