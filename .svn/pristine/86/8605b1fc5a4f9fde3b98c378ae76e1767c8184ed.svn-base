{"version":3,"sources":["helmet.js"],"names":["Actor","require","FSM","Sleep","TopTurn","Slide","Walk","cc","Class","extends","properties","init","actorType","arguments","color","hDefSpe","vDefSpe","defSlideSpe","dir","DIR","DIR_LEFT","state","ENUM","HELMET_STATE","WALK","isOnLand","isDie","animation","node","getComponent","Animation","enableCollsi","enableMove","fsm","addState","setDefaultState","getHSpeed","SLIDE","getVSpeed","interactive","actor","sizeOne","getSize","sizeTwo","actorCollsition","isFlashing","die","isInvincible","y","height","isUpOrDown","littleJump","flat","SLEEP","x","DIR_RIGHT","switchState","EM","emit","type","SCORE_EFFECT","v2","DUCK_STATE","getFormState","FORM_STATE","SMALL","switchStateWithStack","size","getContentSize","width","rect","turnRight","scaleX","turnLeft","pause","isPause","resume","changeDir","hCurrSpeed","onCollsiWithPBullet","bullet","update","dt","backPos","move","isOutScreen","removeFromParent","tile","getDownCollsiTile","TILE_TYPE","LAND","PIPE_H_ENTRY","WALL","PIPE_V_ENTRY","QUESTION","collsiDown","vCurrSpeed","getRightCollsiTile","collsiRight","getLeftCollsiTile","collsiLeft","oldPos","vCurrAcceleration","collsiWithMon","getActorType","MON_TYPE","ROCKET","DUCK","HELMET"],"mappings":"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","file":"helmet.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\monster","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\nvar Actor=require(\"actor\");\r\nvar FSM=require(\"FSM\");\r\nvar {Sleep,TopTurn,Slide,Walk}=require(\"helmetState\");\r\ncc.Class({\r\n    extends:Actor,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    init(){\r\n        this.actorType=arguments[0];\r\n        this.color=arguments[1];  \r\n        this.hDefSpe=90;\r\n        this.vDefSpe=-380;\r\n        this.defSlideSpe=500;\r\n        this.dir=DIR.DIR_LEFT;\r\n        this.state=ENUM.HELMET_STATE.WALK;\r\n        this.isOnLand=true;\r\n        this.isDie=false;\r\n        this.animation=this.node.getComponent(cc.Animation);\r\n        this.enableCollsi=true;\r\n        this.enableMove=true;\r\n        \r\n\r\n        this.fsm=new FSM();\r\n        this.fsm.addState(new Slide(this,\"slide\"));\r\n        this.fsm.addState(new Walk(this,\"walk\"));\r\n        this.fsm.addState(new Sleep(this,\"sleep\"));\r\n        this.fsm.addState(new TopTurn(this,\"topturn\"));\r\n\r\n        this.fsm.setDefaultState(\"walk\");\r\n\r\n    },\r\n    getHSpeed(){\r\n        if(this.state===ENUM.HELMET_STATE.SLIDE){\r\n            return this.dir===DIR.DIR_LEFT?-this.defSlideSpe:this.defSlideSpe;\r\n        }else{\r\n            return this.dir===DIR.DIR_LEFT?-this.hDefSpe:this.hDefSpe;\r\n        }\r\n    },\r\n    getVSpeed(){\r\n        return this.vDefSpe;\r\n    },\r\n    interactive(actor){\r\n        if(this.isDie||actor.isDie)return;\r\n        let sizeOne=actor.getSize();\r\n        let sizeTwo=this.getSize();\r\n        if(this.actorCollsition(sizeOne,sizeTwo)){\r\n            //闪烁状态碰到怪物\r\n            if(actor.isFlashing){\r\n                this.die();\r\n            }\r\n            //无敌状态碰到怪物\r\n            else if(actor.isInvincible){\r\n                //踩到怪物\r\n                if(sizeOne.y>=sizeTwo.y+sizeTwo.height/2&&!actor.isUpOrDown()){\r\n                    actor.littleJump();\r\n                    actor.node.y=sizeTwo.y+sizeTwo.height+1;\r\n                    this.flat(sizeOne);\r\n                }else if(this.state===ENUM.HELMET_STATE.SLEEP){\r\n                    sizeOne.x>this.node.x?this.dir=DIR.DIR_LEFT:this.dir=DIR.DIR_RIGHT;\r\n                    this.fsm.switchState(\"slide\");\r\n                    EM.emit(EM.type.SCORE_EFFECT,cc.v2(this.node.x,this.node.y+80),200);\r\n                }\r\n            }\r\n            //普通状态碰到蘑菇\r\n            else{\r\n                //踩到蘑菇\r\n                if(sizeOne.y>=sizeTwo.y+sizeTwo.height/2){\r\n                    actor.littleJump();\r\n                    actor.node.y=sizeTwo.y+sizeTwo.height+1;\r\n                    this.flat(sizeOne);\r\n                }else if(this.state===ENUM.DUCK_STATE.SLEEP){\r\n                    sizeOne.x>this.node.x?this.dir=DIR.DIR_LEFT:this.dir=DIR.DIR_RIGHT;\r\n                    this.fsm.switchState(\"slide\");\r\n                    EM.emit(EM.type.SCORE_EFFECT,cc.v2(this.node.x,this.node.y+80),200);\r\n                }else if(actor.getFormState()!==FORM_STATE.SMALL){\r\n                    actor.fsm.switchStateWithStack(\"to_small\");\r\n                }else{\r\n                    actor.fsm.switchState(\"die\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n    getSize(){\r\n        let size=this.node.getContentSize();\r\n        let height=size.height-4;\r\n        let width=size.width-4;\r\n        return cc.rect(this.node.x,this.node.y,width,height);\r\n    },\r\n    turnRight(){\r\n        this.node.scaleX=-1;\r\n        this.dir=DIR.DIR_RIGHT;\r\n    },\r\n    turnLeft(){\r\n        this.node.scaleX=1;\r\n        this.dir=DIR.DIR_LEFT;\r\n    },\r\n    pause(){\r\n        this.isPause=true;\r\n        this.animation.pause();\r\n    },\r\n    resume(){\r\n        this.isPause=false;\r\n        this.animation.resume();\r\n    },\r\n    changeDir(){\r\n        this.dir===DIR.DIR_LEFT?this.turnRight():this.turnLeft();\r\n        this.hCurrSpeed=this.getHSpeed();\r\n    },\r\n    die(){\r\n        this.fsm.switchState(\"topturn\");\r\n        EM.emit(EM.type.SCORE_EFFECT,cc.v2(this.node.x,this.node.y+80),200);\r\n    },\r\n    flat(sizeOne){\r\n        switch(this.state){\r\n            case ENUM.DUCK_STATE.SLIDE:\r\n            case ENUM.DUCK_STATE.WALK:\r\n            this.fsm.switchState(\"sleep\");\r\n            break;\r\n            case ENUM.DUCK_STATE.SLEEP:\r\n            sizeOne.x>this.node.x?this.dir=DIR.DIR_LEFT:this.dir=DIR.DIR_RIGHT;\r\n            this.fsm.switchState(\"slide\");\r\n            break;\r\n        }\r\n        EM.emit(EM.type.SCORE_EFFECT,cc.v2(this.node.x,this.node.y+80),200);\r\n    },\r\n    onCollsiWithPBullet(bullet){\r\n        bullet.die();\r\n    },\r\n    update (dt) {\r\n        if(this.isPause)return;\r\n\r\n        if(this.enableMove){\r\n            this.backPos();\r\n\r\n            this.move(dt);\r\n    \r\n            if(this.isOutScreen()){\r\n                this.node.removeFromParent();\r\n            }\r\n        }\r\n\r\n        if(this.enableCollsi){\r\n            let tile=null;\r\n\r\n            //脚底的碰撞检测\r\n            tile=this.getDownCollsiTile();\r\n            if(tile.type){\r\n                switch(tile.type){\r\n                    case TILE_TYPE.LAND:\r\n                    case TILE_TYPE.PIPE_H_ENTRY:\r\n                    case TILE_TYPE.WALL:\r\n                    case TILE_TYPE.PIPE_V_ENTRY:  \r\n                    case TILE_TYPE.QUESTION:\r\n                        this.collsiDown(tile.tile);\r\n                    break;                    \r\n                }\r\n            }else{\r\n                if(this.isOnLand){\r\n                    this.isOnLand=false;\r\n                    this.vCurrSpeed=this.getVSpeed();\r\n                }\r\n            }\r\n    \r\n            tile=this.getRightCollsiTile();\r\n            if(tile.type){\r\n                switch(tile.type){\r\n                    case TILE_TYPE.LAND:\r\n                    case TILE_TYPE.PIPE_H_ENTRY:\r\n                    case TILE_TYPE.PIPE_V_ENTRY:  \r\n                        this.collsiRight(tile.tile);\r\n                    break;                    \r\n                }\r\n            }\r\n    \r\n            tile=this.getLeftCollsiTile();\r\n            if(tile.type){\r\n                switch(tile.type){\r\n                    case TILE_TYPE.LAND:\r\n                    case TILE_TYPE.PIPE_H_ENTRY:\r\n                    case TILE_TYPE.PIPE_V_ENTRY:  \r\n                        this.collsiLeft(tile.tile);\r\n                    break;                    \r\n                }\r\n            }\r\n    \r\n            this.fsm.update(dt);\r\n\r\n        }\r\n\r\n    },\r\n    collsiLeft(tile){\r\n        this.changeDir();\r\n        this.node.x=this.getSize().width/2+tile.node.x+40+1;\r\n    },\r\n    collsiRight(tile){\r\n        this.changeDir();\r\n        this.node.x=tile.node.x-this.getSize().width/2-1;\r\n    },\r\n    collsiDown(tile){\r\n        if(this.isOnLand)return;\r\n        let size=this.getSize();\r\n        if((this.oldPos.y>=tile.node.y)\r\n        &&((this.oldPos.x-size.width/2>=tile.node.x&&this.oldPos.x-size.width/2<=tile.node.x+40)\r\n        ||(this.oldPos.x+size.width/2>=tile.node.x&&this.oldPos.x+size.width/2<=tile.node.x+40))){\r\n            this.node.y=tile.node.y+40;\r\n            this.isOnLand=true;\r\n            this.vCurrSpeed=0;\r\n            this.vCurrAcceleration=0;\r\n        }\r\n    },\r\n    //与怪物的碰撞检测\r\n    collsiWithMon(actor){\r\n        if(this.isDie)return;\r\n        let sizeOne=actor.getSize();\r\n        let sizeTwo=this.getSize();\r\n        if(this.actorCollsition(sizeOne,sizeTwo)){\r\n            if(actor.getActorType()===ENUM.MON_TYPE.ROCKET){\r\n                return;\r\n            }\r\n            if(actor.getActorType()===ENUM.MON_TYPE.DUCK){\r\n                if(this.state===ENUM.HELMET_STATE.SLIDE){\r\n                    if(actor.state===ENUM.DUCK_STATE.SLIDE){\r\n                        this.die();\r\n                        actor.die();\r\n                    }else{\r\n                        if(!actor.isDie)actor.die();\r\n                    }\r\n                }else if(this.state===ENUM.HELMET_STATE.SLEEP){\r\n                    if(actor.state===ENUM.DUCK_STATE.SLIDE){\r\n                        this.die();\r\n                    }else{\r\n                        if(!actor.isDie)actor.changeDir();\r\n                        this.node.x<actor.node.x?\r\n                        actor.node.x=sizeTwo.x+sizeTwo.width/2+sizeOne.width/2+1:\r\n                        actor.node.x=sizeTwo.x-sizeTwo.width/2-sizeOne.width/2-1;\r\n                    }\r\n                }else{\r\n                    if(actor.state===ENUM.DUCK_STATE.SLIDE){\r\n                        this.die();\r\n                    }else{\r\n                        if(!actor.isDie)actor.changeDir();\r\n                        this.changeDir();\r\n                        this.node.x>actor.node.x?\r\n                        this.node.x=sizeOne.x+sizeOne.width/2+sizeTwo.width/2+1:\r\n                        this.node.x=sizeOne.x-sizeOne.width/2-sizeTwo.width/2-1;\r\n                    }\r\n                }\r\n            }\r\n            else if(actor.getActorType()===ENUM.MON_TYPE.HELMET){\r\n                if(this.state===ENUM.HELMET_STATE.SLIDE){\r\n                    if(actor.state===ENUM.HELMET_STATE.SLIDE){\r\n                        this.die();\r\n                        actor.die();\r\n                    }else{\r\n                        if(!actor.isDie)actor.die();\r\n                    }\r\n                }else if(this.state===ENUM.HELMET_STATE.SLEEP){\r\n                    if(actor.state===ENUM.HELMET_STATE.SLIDE){\r\n                        this.die();\r\n                    }else{\r\n                        if(!actor.isDie)actor.changeDir();\r\n                        this.node.x<actor.node.x?\r\n                        actor.node.x=sizeTwo.x+sizeTwo.width/2+sizeOne.width/2+1:\r\n                        actor.node.x=sizeTwo.x-sizeTwo.width/2-sizeOne.width/2-1;\r\n                    }\r\n                }else{\r\n                    if(actor.state===ENUM.HELMET_STATE.SLIDE){\r\n                        this.die();\r\n                    }else{\r\n                        if(!actor.isDie)actor.changeDir();\r\n                        this.changeDir();\r\n                        this.node.x>actor.node.x?\r\n                        this.node.x=sizeOne.x+sizeOne.width/2+sizeTwo.width/2+1:\r\n                        this.node.x=sizeOne.x-sizeOne.width/2-sizeTwo.width/2-1;\r\n                    }\r\n                }\r\n            }\r\n            else{\r\n                if(this.state===ENUM.HELMET_STATE.SLIDE){\r\n                    if(!actor.isDie)actor.die();\r\n                }else if(this.state===ENUM.DUCK_STATE.SLEEP){\r\n                    if(!actor.isDie)actor.changeDir();\r\n                    this.node.x<actor.node.x?\r\n                    actor.node.x=sizeTwo.x+sizeTwo.width/2+sizeOne.width/2+1:\r\n                    actor.node.x=sizeTwo.x-sizeTwo.width/2-sizeOne.width/2-1;\r\n                }else{\r\n                    if(!actor.isDie)actor.changeDir();\r\n                    this.changeDir();\r\n                    this.node.x>actor.node.x?\r\n                    this.node.x=sizeOne.x+sizeOne.width/2+sizeTwo.width/2+1:\r\n                    this.node.x=sizeOne.x-sizeOne.width/2-sizeTwo.width/2-1;\r\n                }\r\n            }\r\n        }\r\n    }\r\n});\r\n"]}