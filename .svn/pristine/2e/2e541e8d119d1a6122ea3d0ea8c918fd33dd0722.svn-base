{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\monster/assets\\script\\monster\\octopus.js"],"names":["Actor","require","SWIM_DIR","SWIM_DOWN","SWIM_LEFT","SWIM_RIGHT","SWIM_UP","cc","Class","extends","properties","init","isAllowSwim","animation","node","getComponent","Animation","isDie","swimLeft","moveLeft","moveBy","v2","moveDown","runAction","sequence","callFunc","playSwimAni","swimRight","moveRight","swimDown","playFloatAni","swimUp","moveUp","getSwimDir","dir","x","gm","currPlayer","y","Math","floor","random","getSize","size","getContentSize","rect","width","height","update","dt","isPause","move","isOutScreen","removeFromParent","play","die","stop","scaleY","vCurrSpeed","vCurrAcceleration","hCurrSpeed","hCurrAcceleration","pause","pauseAllActions","isPuase","resume","resumeAllActions","interactive","actor","sizeOne","sizeTwo","actorCollsition","isFlashing","isInvincible","getFormState","FORM_STATE","SMALL","fsm","switchStateWithStack","switchState","onCollsiWithPBullet","bullet"],"mappings":"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","file":"octopus.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\monster","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\nvar Actor=require(\"actor\");\r\n\r\nvar SWIM_DIR={\r\n    SWIM_DOWN:0,\r\n    SWIM_LEFT:1,\r\n    SWIM_RIGHT:2,\r\n    SWIM_UP:3\r\n}\r\n\r\ncc.Class({\r\n    extends:Actor,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n    init(){\r\n        this.isAllowSwim=true;\r\n        this.animation=this.node.getComponent(cc.Animation);\r\n        this.isDie=false;\r\n    },\r\n    swimLeft(){\r\n        let moveLeft=cc.moveBy(0.3,cc.v2(-80,80));\r\n        let moveDown=cc.moveBy(1,cc.v2(0,-80));\r\n        this.node.runAction(cc.sequence(moveLeft,cc.callFunc(function(){\r\n            this.playSwimAni();\r\n        },this),moveDown,cc.callFunc(()=>{\r\n            this.isAllowSwim=true;\r\n        })));\r\n    },\r\n    swimRight(){\r\n        let moveRight=cc.moveBy(0.3,cc.v2(80,80));\r\n        let moveDown=cc.moveBy(1,cc.v2(0,-80));\r\n        this.node.runAction(cc.sequence(moveRight,cc.callFunc(function(){\r\n            this.playSwimAni();\r\n        },this),moveDown,cc.callFunc(()=>{\r\n            this.isAllowSwim=true;\r\n        })));\r\n    },\r\n    swimDown(){\r\n        let moveDown=cc.moveBy(1,cc.v2(0,-80));\r\n        this.playFloatAni();\r\n        this.node.runAction(cc.sequence(moveDown,cc.callFunc(()=>{\r\n            this.isAllowSwim=true;\r\n        })));\r\n    },\r\n    swimUp(){\r\n        let moveUp=cc.moveBy(1,cc.v2(0,80));\r\n        this.playFloatAni();\r\n        this.node.runAction(cc.sequence(moveUp,cc.callFunc(()=>{\r\n            this.isAllowSwim=true;\r\n        })));\r\n    },\r\n    getSwimDir(){\r\n        let dir=0;\r\n        //如果章鱼离人很远朝着人的方向移动\r\n        if(this.node.x>gm.currPlayer.x+80){\r\n            dir=SWIM_DIR.SWIM_LEFT;\r\n        }else if(this.node.x<gm.currPlayer.x-80){\r\n            dir=SWIM_DIR.SWIM_RIGHT;\r\n        }else if(this.node.y>40*8){//碰到水面\r\n            dir=Math.floor(Math.random()*3);\r\n        }else if(this.node.y<40*4){\r\n            dir=Math.floor(Math.random()*3)+1;\r\n        }else{\r\n            dir=Math.floor(Math.random()*4);\r\n        }\r\n        return dir;\r\n    },\r\n    getSize(){\r\n        let size=this.node.getContentSize();\r\n        return cc.rect(this.node.x,this.node.y,size.width,size.height);\r\n    },\r\n    update (dt) {\r\n        if(this.isPause)return;\r\n\r\n        this.move(dt);\r\n\r\n        if(this.isAllowSwim&&!this.isDie){\r\n            let dir=this.getSwimDir();\r\n            switch(dir){\r\n                case  SWIM_DIR.SWIM_DOWN:\r\n                    this.swimDown();\r\n                break;\r\n                case  SWIM_DIR.SWIM_UP:\r\n                    this.swimUp();    \r\n                break;\r\n                case  SWIM_DIR.SWIM_LEFT:\r\n                    this.swimLeft();\r\n                break;\r\n                case  SWIM_DIR.SWIM_RIGHT:\r\n                    this.swimRight();\r\n                break;\r\n            }\r\n            this.isAllowSwim=false;\r\n        }\r\n\r\n        if(this.isOutScreen()){\r\n            this.node.removeFromParent();\r\n        }\r\n    },\r\n    playSwimAni(){\r\n        this.animation.play(\"swim\");\r\n    },\r\n    playFloatAni(){\r\n        this.animation.play(\"float\");\r\n    },\r\n    die(){\r\n        this.animation.stop();\r\n        this.isDie=true;\r\n        this.node.scaleY=-1;\r\n        this.node.y+=40;\r\n        this.vCurrSpeed=300;\r\n        this.vCurrAcceleration=-1400;\r\n        this.hCurrSpeed=0;\r\n        this.hCurrAcceleration=0;\r\n    },\r\n    pause(){\r\n        this.node.pauseAllActions();\r\n        this.animation.pause();\r\n        this.isPuase=true;\r\n    },\r\n    resume(){\r\n        this.node.resumeAllActions();\r\n        this.animation.resume();\r\n        this.isPuase=false;\r\n    },\r\n    interactive(actor){\r\n        if(this.isDie||actor.isDie)return;\r\n        let sizeOne=actor.getSize();\r\n        let sizeTwo=this.getSize();\r\n        if(this.actorCollsition(sizeOne,sizeTwo)){\r\n                //闪烁状态碰到怪物\r\n                if(actor.isFlashing){\r\n                    this.die();\r\n                }            //无敌状态碰到怪物\r\n                else if(actor.isInvincible){\r\n\r\n                }\r\n                //普通状态碰到蘑菇\r\n                else{\r\n                    if(actor.getFormState()!==FORM_STATE.SMALL){\r\n                        actor.fsm.switchStateWithStack(\"to_small\");\r\n                    }else{\r\n                        actor.fsm.switchState(\"die\");\r\n                    }\r\n                }\r\n            }\r\n        },\r\n    onCollsiWithPBullet(bullet){\r\n        bullet.die();\r\n        this.die();\r\n    }\r\n});\r\n"]}