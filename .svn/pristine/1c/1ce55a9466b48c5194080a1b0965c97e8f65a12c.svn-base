{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\prop/assets\\script\\prop\\mush.js"],"names":["Actor","require","cc","Class","extends","properties","redSkin","SpriteFrame","blueSkin","lvUpSkin","init","hDefaultSpe","type","arguments","isPause","hCurrSpeed","dir","DIR","DIR_RIGHT","isOnLand","currSkin","ENUM","PROP_COLOR","RED","BLUE","PROP_TYPE","LIFE","node","getComponent","Sprite","spriteFrame","playBorthAni","moveUp","moveBy","v2","runAction","sequence","callFunc","interactive","actor","sizeOne","getSize","sizeTwo","rectOne","rect","x","width","y","height","rectTwo","Intersection","rectRect","fsm","switchStateWithStack","removeFromParent","EM","emit","ADD_LIFE","LIFE_EFFECT","size","getContentSize","update","dt","backPos","move","tile","getDownCollsiTile","TILE_TYPE","LAND","PIPE_H_ENTRY","WALL","PIPE_V_ENTRY","QUESTION","collsiDown","vCurrSpeed","getRightCollsiTile","collsiRight","getLeftCollsiTile","collsiLeft","isOutScreen","turnRight","turnLeft","oldPos","vCurrAcceleration","DIR_LEFT","pause","resume","onCollsiPushWall","wallBox"],"mappings":"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","file":"mush.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\prop","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\nvar Actor=require(\"actor\");\r\n\r\ncc.Class({\r\n    extends:Actor,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n        redSkin:cc.SpriteFrame,\r\n        blueSkin:cc.SpriteFrame,\r\n        lvUpSkin:cc.SpriteFrame\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    //onLoad ()\r\n    init(){\r\n        this.hDefaultSpe=180;\r\n        this.type=arguments[1];\r\n        this.isPause=true;           //禁止碰撞检测\r\n        this.hCurrSpeed=this.hDefaultSpe;\r\n        this.dir=DIR.DIR_RIGHT;\r\n        this.isOnLand=true; \r\n        let currSkin=null;\r\n        switch(this.type){\r\n            case ENUM.PROP_COLOR.RED:\r\n                currSkin=this.redSkin;\r\n            break;\r\n            case ENUM.PROP_COLOR.BLUE:\r\n                currSkin=this.blueSkin;\r\n            break;\r\n            case ENUM.PROP_TYPE.LIFE:\r\n                currSkin=this.lvUpSkin;\r\n            break;\r\n        } \r\n        this.node.getComponent(cc.Sprite).spriteFrame=currSkin;  \r\n        this.playBorthAni();                           \r\n    },\r\n    //出场动画\r\n    playBorthAni(){\r\n        let moveUp=cc.moveBy(0.6,cc.v2(0,42));\r\n        this.node.runAction(cc.sequence(moveUp,cc.callFunc(function(){\r\n            this.isPause=false;\r\n        },this)));\r\n    },\r\n    interactive(actor){\r\n        let sizeOne=actor.getSize();\r\n        let sizeTwo=this.getSize();\r\n        let rectOne=cc.rect(sizeOne.x-sizeOne.width/2,sizeOne.y,sizeOne.width,sizeOne.height);\r\n        let rectTwo=cc.rect(sizeTwo.x-sizeTwo.width/2,sizeTwo.y,sizeTwo.width,sizeTwo.height);\r\n        if(cc.Intersection.rectRect(rectOne,rectTwo)){\r\n            switch(this.type){\r\n                case ENUM.PROP_COLOR.RED:\r\n                case ENUM.PROP_COLOR.BLUE:\r\n                    actor.fsm.switchStateWithStack(\"to_big\");\r\n                    this.node.removeFromParent();\r\n                break;\r\n                case ENUM.PROP_TYPE.LIFE:\r\n                    this.node.removeFromParent();\r\n                    EM.emit(EM.type.ADD_LIFE,1);\r\n                    EM.emit(EM.type.LIFE_EFFECT,cc.v2(this.node.x,this.node.y+80));\r\n                break;\r\n            } \r\n        }\r\n    },\r\n    getSize(){\r\n        let size=this.node.getContentSize();\r\n        let height=size.height-4;\r\n        let width=size.width-14;\r\n        return cc.rect(this.node.x,this.node.y,width,height);\r\n    },\r\n    update (dt) {\r\n        if(this.isPause)return;\r\n\r\n        this.backPos();\r\n\r\n        this.move(dt);\r\n\r\n        let tile=null;\r\n\r\n        //脚底的碰撞检测\r\n        tile=this.getDownCollsiTile();\r\n        if(tile.type){\r\n            switch(tile.type){\r\n                case TILE_TYPE.LAND:\r\n                case TILE_TYPE.PIPE_H_ENTRY:\r\n                case TILE_TYPE.WALL:\r\n                case TILE_TYPE.PIPE_V_ENTRY:  \r\n                case TILE_TYPE.QUESTION:\r\n                    this.collsiDown(tile.tile);\r\n                break;                    \r\n            }\r\n        }else{\r\n            if(this.isOnLand){\r\n                this.isOnLand=false;\r\n                this.vCurrSpeed=-380;\r\n            }\r\n        }\r\n\r\n        tile=this.getRightCollsiTile();\r\n        if(tile.type){\r\n            switch(tile.type){\r\n                case TILE_TYPE.LAND:\r\n                case TILE_TYPE.PIPE_H_ENTRY:\r\n                case TILE_TYPE.WALL:\r\n                case TILE_TYPE.PIPE_V_ENTRY:  \r\n                case TILE_TYPE.QUESTION:\r\n                    this.collsiRight(tile.tile);\r\n                break;                    \r\n            }\r\n        }\r\n\r\n\r\n        tile=this.getLeftCollsiTile();\r\n        if(tile.type){\r\n            switch(tile.type){\r\n                case TILE_TYPE.LAND:\r\n                case TILE_TYPE.PIPE_H_ENTRY:\r\n                case TILE_TYPE.WALL:\r\n                case TILE_TYPE.PIPE_V_ENTRY:  \r\n                case TILE_TYPE.QUESTION:\r\n                    this.collsiLeft(tile.tile);\r\n                break;                    \r\n            }\r\n        }\r\n\r\n        if(this.isOutScreen()){\r\n            this.node.removeFromParent();\r\n        }\r\n\r\n    },\r\n    collsiLeft(tile){\r\n        this.turnRight();\r\n        this.node.x=this.getSize().width/2+tile.node.x+40+1;\r\n    },\r\n    collsiRight(tile){\r\n        this.turnLeft();\r\n        this.node.x=tile.node.x-this.getSize().width/2-1;\r\n    },\r\n    collsiDown(tile){\r\n        if(this.isOnLand)return;\r\n        let size=this.getSize();\r\n        if((this.oldPos.y>=tile.node.y)\r\n        &&((this.oldPos.x-size.width/2>=tile.node.x&&this.oldPos.x-size.width/2<=tile.node.x+40)\r\n        ||(this.oldPos.x+size.width/2>=tile.node.x&&this.oldPos.x+size.width/2<=tile.node.x+40))){\r\n            this.isOnLand=true;\r\n            this.node.y=tile.node.y+40;\r\n            this.vCurrSpeed=0;\r\n            this.vCurrAcceleration=0;\r\n        }\r\n    },\r\n    turnRight(){\r\n        this.dir=DIR.DIR_RIGHT;\r\n        this.hCurrSpeed=this.hDefaultSpe;\r\n    },\r\n    turnLeft(){\r\n        this.dir=DIR.DIR_LEFT;\r\n        this.hCurrSpeed=-this.hDefaultSpe;\r\n    },\r\n    pause(){\r\n        this.isPause=true;\r\n    },\r\n    resume(){\r\n        this.isPause=false;\r\n    },\r\n    onCollsiPushWall(wallBox){\r\n        this.node.y=wallBox.y+20;\r\n        this.node.x>wallBox.x?this.turnRight():this.turnLeft();\r\n    }\r\n});"]}