{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\monster/assets\\script\\monster\\duck.js"],"names":["Actor","require","FSM","Sleep","TopTurn","Flash","Slide","UpDown","Fly","Jump","Walk","Fall","cc","Class","extends","properties","init","animation","node","getComponent","Animation","dir","DIR","DIR_LEFT","type","arguments","state","actorType","flag","hDefSpe","vDefSpe","defSlideSpe","isDie","fsm","addState","ENUM","DUCK_STATE","WALK","setDefaultState","FLY","JUMP","UP_DOWN","interactive","actor","sizeOne","getSize","sizeTwo","actorCollsition","isFlashing","die","isInvincible","y","height","isUpOrDown","littleJump","flat","SLEEP","FLASH","x","DIR_RIGHT","switchState","EM","emit","SCORE_EFFECT","v2","getFormState","FORM_STATE","SMALL","switchStateWithStack","size","getContentSize","width","rect","update","dt","isPause","enableMove","backPos","move","isOutScreen","removeFromParent","enableCollsi","tile","getDownCollsiTile","TILE_TYPE","LAND","PIPE_H_ENTRY","WALL","PIPE_V_ENTRY","QUESTION","collsiDown","isOnLand","vCurrSpeed","getVSpeed","getRightCollsiTile","collsiRight","getLeftCollsiTile","collsiLeft","checkChangeDir","changeDir","oldPos","SLIDE","vCurrAcceleration","FALL","jump","parseInt","gm","mapMgr","getObstacleTileAt","turnRight","scaleX","turnLeft","pause","resume","hCurrSpeed","getHSpeed","collsiWithMon","getActorType","MON_TYPE","DUCK","onCollsiPushWall","wallBox","onCollsiWithPBullet","bullet"],"mappings":"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","file":"duck.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\monster","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\nvar Actor=require(\"actor\");\r\nvar FSM=require(\"FSM\");\r\nvar {Sleep,TopTurn,Flash,Slide,UpDown,Fly,Jump,Walk,Fall}=require(\"duckState\");\r\ncc.Class({\r\n    extends:Actor,\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n        \r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    init(){\r\n        this.animation=this.node.getComponent(cc.Animation);\r\n        this.dir=DIR.DIR_LEFT;                              //方向\r\n        this.type=arguments[1];\r\n        this.state=arguments[2];\r\n        this.actorType=arguments[0];\r\n        this.flag=arguments[3]\r\n        this.hDefSpe=90;\r\n        this.vDefSpe=-380;\r\n        this.defSlideSpe=500;\r\n\r\n        this.isDie=false;\r\n        this.fsm=new FSM();\r\n        this.fsm.addState(new Slide(this,\"slide\"));\r\n        this.fsm.addState(new Walk(this,\"walk\"));\r\n        this.fsm.addState(new Sleep(this,\"sleep\"));\r\n        this.fsm.addState(new TopTurn(this,\"topturn\"));\r\n        this.fsm.addState(new Flash(this,\"flash\"));\r\n        this.fsm.addState(new UpDown(this,\"updown\"));\r\n        this.fsm.addState(new Fly(this,\"fly\"));\r\n        this.fsm.addState(new Jump(this,\"jump\"));\r\n        this.fsm.addState(new Fall(this,\"fall\"));\r\n\r\n        switch(this.state){\r\n            case ENUM.DUCK_STATE.WALK:\r\n            this.fsm.setDefaultState(\"walk\");\r\n            break;\r\n            case ENUM.DUCK_STATE.FLY:\r\n            this.fsm.setDefaultState(\"fly\");\r\n            break;\r\n            case ENUM.DUCK_STATE.JUMP:\r\n            this.fsm.setDefaultState(\"jump\");\r\n            break;\r\n            case ENUM.DUCK_STATE.UP_DOWN:\r\n            this.fsm.setDefaultState(\"updown\");\r\n            break;\r\n        }\r\n        \r\n    }, \r\n    // onLoad () {},\r\n    interactive(actor){\r\n        if(this.isDie||actor.isDie)return;\r\n        let sizeOne=actor.getSize();\r\n        let sizeTwo=this.getSize();\r\n        if(this.actorCollsition(sizeOne,sizeTwo)){\r\n            //闪烁状态碰到怪物\r\n            if(actor.isFlashing){\r\n                this.die();\r\n            }\r\n            //无敌状态碰到怪物\r\n            else if(actor.isInvincible){\r\n                //踩到怪物\r\n                if(sizeOne.y>=sizeTwo.y+sizeTwo.height/2&&!actor.isUpOrDown()){\r\n                    actor.littleJump();\r\n                    actor.node.y=sizeTwo.y+sizeTwo.height+1;\r\n                    this.flat(sizeOne);\r\n                }else if(this.state===ENUM.DUCK_STATE.SLEEP||this.state===ENUM.DUCK_STATE.FLASH){\r\n                    sizeOne.x>this.node.x?this.dir=DIR.DIR_LEFT:this.dir=DIR.DIR_RIGHT;\r\n                    this.fsm.switchState(\"slide\");\r\n                    EM.emit(EM.type.SCORE_EFFECT,cc.v2(this.node.x,this.node.y+80),200);\r\n                }\r\n            }\r\n            //普通状态碰到蘑菇\r\n            else{\r\n                //踩到蘑菇\r\n                if(sizeOne.y>=sizeTwo.y+sizeTwo.height/2){\r\n                    actor.littleJump();\r\n                    actor.node.y=sizeTwo.y+sizeTwo.height+1;\r\n                    this.flat(sizeOne);\r\n                }else if(this.state===ENUM.DUCK_STATE.SLEEP||this.state===ENUM.DUCK_STATE.FLASH){\r\n                    sizeOne.x>this.node.x?this.dir=DIR.DIR_LEFT:this.dir=DIR.DIR_RIGHT;\r\n                    this.fsm.switchState(\"slide\");\r\n                    EM.emit(EM.type.SCORE_EFFECT,cc.v2(this.node.x,this.node.y+80),200);\r\n                }else if(actor.getFormState()!==FORM_STATE.SMALL){\r\n                    actor.fsm.switchStateWithStack(\"to_small\");\r\n                }else{\r\n                    actor.fsm.switchState(\"die\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n    getSize(){\r\n        let size=this.node.getContentSize();\r\n        let height=size.height-4;\r\n        let width=size.width-4;\r\n        return cc.rect(this.node.x,this.node.y,width,height);\r\n    },\r\n    update (dt) {\r\n        if(this.isPause)return;\r\n\r\n        if(this.enableMove){\r\n            this.backPos();\r\n\r\n            this.move(dt);\r\n    \r\n            if(this.isOutScreen()){\r\n                this.node.removeFromParent();\r\n            }\r\n        }\r\n\r\n        if(this.enableCollsi){\r\n            let tile=null;\r\n\r\n            //脚底的碰撞检测\r\n            tile=this.getDownCollsiTile();\r\n            if(tile.type){\r\n                switch(tile.type){\r\n                    case TILE_TYPE.LAND:\r\n                    case TILE_TYPE.PIPE_H_ENTRY:\r\n                    case TILE_TYPE.WALL:\r\n                    case TILE_TYPE.PIPE_V_ENTRY:  \r\n                    case TILE_TYPE.QUESTION:\r\n                        this.collsiDown(tile.tile);\r\n                    break;                    \r\n                }\r\n            }else{\r\n                if(this.isOnLand){\r\n                    this.vCurrSpeed=this.getVSpeed();\r\n                }\r\n            }\r\n    \r\n            tile=this.getRightCollsiTile();\r\n            if(tile.type){\r\n                switch(tile.type){\r\n                    case TILE_TYPE.LAND:\r\n                    case TILE_TYPE.PIPE_H_ENTRY:\r\n                    case TILE_TYPE.PIPE_V_ENTRY:  \r\n                        this.collsiRight(tile.tile);\r\n                    break;                    \r\n                }\r\n            }\r\n    \r\n            tile=this.getLeftCollsiTile();\r\n            if(tile.type){\r\n                switch(tile.type){\r\n                    case TILE_TYPE.LAND:\r\n                    case TILE_TYPE.PIPE_H_ENTRY:\r\n                    case TILE_TYPE.PIPE_V_ENTRY:  \r\n                        this.collsiLeft(tile.tile);\r\n                    break;                    \r\n                }\r\n            }\r\n    \r\n            this.fsm.update(dt);\r\n\r\n            this.checkChangeDir();\r\n\r\n        }\r\n\r\n    },\r\n    collsiLeft(tile){\r\n        this.changeDir();\r\n        this.node.x=this.getSize().width/2+tile.node.x+40+1;\r\n    },\r\n    collsiRight(tile){\r\n        this.changeDir();\r\n        this.node.x=tile.node.x-this.getSize().width/2-1;\r\n    },\r\n    collsiDown(tile){\r\n        if(this.isOnLand)return;\r\n        let size=this.getSize();\r\n        if((this.oldPos.y>=tile.node.y)\r\n        &&((this.oldPos.x-size.width/2>=tile.node.x&&this.oldPos.x-size.width/2<=tile.node.x+40)\r\n        ||(this.oldPos.x+size.width/2>=tile.node.x&&this.oldPos.x+size.width/2<=tile.node.x+40))){\r\n            switch(this.state){\r\n                case ENUM.DUCK_STATE.SLIDE:\r\n                case ENUM.DUCK_STATE.WALK:\r\n                this.node.y=tile.node.y+40;\r\n                this.isOnLand=true;\r\n                this.vCurrSpeed=0;\r\n                this.vCurrAcceleration=0;\r\n                break;\r\n                case ENUM.DUCK_STATE.FALL:\r\n                this.node.y=tile.node.y+40;\r\n                this.fsm.switchState(\"walk\");\r\n                break;\r\n                case ENUM.DUCK_STATE.JUMP:\r\n                this.node.y=tile.node.y+40;\r\n                this.jump();\r\n                break;\r\n            }\r\n        }\r\n    },\r\n    checkChangeDir(){\r\n        if(!parseInt(this.flag))return;\r\n        let tile=gm.mapMgr.getObstacleTileAt(cc.v2(this.node.x,this.node.y-1));\r\n        if(!tile.type&&this.state===ENUM.DUCK_STATE.WALK){\r\n            this.changeDir();            \r\n        }\r\n    },\r\n    turnRight(){\r\n        this.node.scaleX=-1;\r\n        this.dir=DIR.DIR_RIGHT;\r\n    },\r\n    turnLeft(){\r\n        this.node.scaleX=1;\r\n        this.dir=DIR.DIR_LEFT;\r\n    },\r\n    pause(){\r\n        this.isPause=true;\r\n        this.animation.pause();\r\n    },\r\n    resume(){\r\n        this.isPause=false;\r\n        this.animation.resume();\r\n    },\r\n    jump(){\r\n        this.vCurrAcceleration=-1200\r\n        this.vCurrSpeed=500;\r\n    },\r\n    changeDir(){\r\n        this.dir===DIR.DIR_LEFT?this.turnRight():this.turnLeft();\r\n        this.hCurrSpeed=this.getHSpeed();\r\n    },\r\n    die(){\r\n        this.fsm.switchState(\"topturn\");\r\n        EM.emit(EM.type.SCORE_EFFECT,cc.v2(this.node.x,this.node.y+80),200);\r\n    },\r\n    flat(sizeOne){\r\n        switch(this.state){\r\n            case ENUM.DUCK_STATE.SLIDE:\r\n            case ENUM.DUCK_STATE.WALK:\r\n            this.fsm.switchState(\"sleep\");\r\n            break;\r\n            case ENUM.DUCK_STATE.SLEEP:\r\n            case ENUM.DUCK_STATE.FLASH:\r\n            sizeOne.x>this.node.x?this.dir=DIR.DIR_LEFT:this.dir=DIR.DIR_RIGHT;\r\n            this.fsm.switchState(\"slide\");\r\n            EM.emit(EM.type.SCORE_EFFECT,cc.v2(this.node.x,this.node.y+80),200);\r\n            break;\r\n            case ENUM.DUCK_STATE.FLY:   \r\n            case ENUM.DUCK_STATE.JUMP:\r\n            case ENUM.DUCK_STATE.UP_DOWN:\r\n            this.fsm.switchState(\"fall\");\r\n            break;\r\n        }\r\n        EM.emit(EM.type.SCORE_EFFECT,cc.v2(this.node.x,this.node.y+80),200);\r\n    },\r\n    getHSpeed(){\r\n        if(this.state===ENUM.DUCK_STATE.SLIDE){\r\n            return this.dir===DIR.DIR_LEFT?-this.defSlideSpe:this.defSlideSpe;\r\n        }else{\r\n            return this.dir===DIR.DIR_LEFT?-this.hDefSpe:this.hDefSpe;\r\n        }\r\n    },\r\n    getVSpeed(){\r\n        switch(this.state){\r\n            case ENUM.DUCK_STATE.SLIDE:\r\n            case ENUM.DUCK_STATE.WALK:\r\n            this.isOnLand=false;\r\n            return this.vDefSpe;\r\n        }\r\n    },\r\n    //与怪物的碰撞检测\r\n    collsiWithMon(actor){\r\n        if(this.isDie)return;\r\n        let sizeOne=actor.getSize();\r\n        let sizeTwo=this.getSize();\r\n        if(this.actorCollsition(sizeOne,sizeTwo)){\r\n            if(actor.getActorType()===ENUM.MON_TYPE.DUCK){\r\n\r\n                if(this.state===ENUM.DUCK_STATE.SLIDE){\r\n                    if(actor.state===ENUM.DUCK_STATE.SLIDE){\r\n                        this.die();\r\n                        actor.die();\r\n                    }else{\r\n                        if(!actor.isDie)actor.die();\r\n                    }\r\n                }else if(this.state===ENUM.DUCK_STATE.SLEEP||this.state===ENUM.DUCK_STATE.FLASH){\r\n                    if(actor.state===ENUM.DUCK_STATE.SLIDE){\r\n                        this.die();\r\n                    }else{\r\n                        if(!actor.isDie)actor.changeDir();\r\n                        this.node.x<actor.node.x?\r\n                        actor.node.x=sizeTwo.x+sizeTwo.width/2+sizeOne.width/2+1:\r\n                        actor.node.x=sizeTwo.x-sizeTwo.width/2-sizeOne.width/2-1;\r\n                    }\r\n                }else{\r\n                    if(!actor.isDie)actor.changeDir();\r\n                    this.changeDir();\r\n                    this.node.x>actor.node.x?\r\n                    this.node.x=sizeOne.x+sizeOne.width/2+sizeTwo.width/2+1:\r\n                    this.node.x=sizeOne.x-sizeOne.width/2-sizeTwo.width/2-1;\r\n                }\r\n            }else{\r\n                if(this.state===ENUM.DUCK_STATE.SLIDE){\r\n                    if(!actor.isDie)actor.die();\r\n                }else if(this.state===ENUM.DUCK_STATE.SLEEP||this.state===ENUM.DUCK_STATE.FLASH){\r\n                    if(!actor.isDie)actor.changeDir();\r\n                    this.node.x<actor.node.x?\r\n                    actor.node.x=sizeTwo.x+sizeTwo.width/2+sizeOne.width/2+1:\r\n                    actor.node.x=sizeTwo.x-sizeTwo.width/2-sizeOne.width/2-1;\r\n                }else{\r\n                    if(!actor.isDie)actor.changeDir();\r\n                    this.changeDir();\r\n                    this.node.x>actor.node.x?\r\n                    this.node.x=sizeOne.x+sizeOne.width/2+sizeTwo.width/2+1:\r\n                    this.node.x=sizeOne.x-sizeOne.width/2-sizeTwo.width/2-1;\r\n                }\r\n            }\r\n        }\r\n    },\r\n    onCollsiPushWall(wallBox){\r\n        this.die();\r\n    },\r\n    onCollsiWithPBullet(bullet){\r\n        bullet.die();\r\n        this.die();\r\n    }\r\n});\r\n\r\n"]}