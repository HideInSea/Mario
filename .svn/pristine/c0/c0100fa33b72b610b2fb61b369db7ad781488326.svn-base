{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\state/assets\\script\\state\\playerState.js"],"names":["State","require","Stand","cc","Class","extends","handleInput","input","keyCode","macro","KEY","k","type","target","isKPressed","isOnWater","_fsm","switchState","a","isAPressed","turnLeft","d","isDPressed","turnRight","s","isSPressed","getFormState","FORM_STATE","SMALL","j","isJPressed","FIRE","fire","onEnter","setPlayerState","PLAYER_STATE","STAND","hCurrAcceleration","hCurrSpeed","vCurrAcceleration","vCurrSpeed","playStandAni","resume","animation","play","BIG","checkFallTransition","isOnLand","update","dt","Jump","ctor","orignDir","vMaxAcceleration","getAcceleration","checkStandTransition","checkSlideTransition","checkWalkTransition","checkHStop","isReserveSpeed","JUMP","playJumpAni","vMinAcceleration","Math","abs","hSpeMaxSpeed","vSpeOrignSpeed","vOrignSpeed","hCurrMaxSpeed","getMaxSpeed","onExit","hNorAcceleration","hNorSlowAcceleration","hNorMaxSpeed","Walk","animationState","pauseDir","updateAniSpeed","WALK","playWalkAni","hWaterAcceleration","hSpeAcceleration","dir","DIR","DIR_LEFT","hWaterMaxSpeed","DIR_RIGHT","speed","pause","Slide","SLIDE","playSlideAni","node","scaleX","hSpeSlowAcceleration","Squat","isOnSky","orignSpeed","SQUAT","playSquatAni","checkVStop","Fire","interval","id","playFireAni","behind","runAction","sequence","delayTime","callFunc","switchPreState","pauseAllActions","resumeAllActions","Fall","FALL","playFallAni","Swim","isPlaying","vWaterMinAcceleration","vWaterOrignSpeed","playSwinAni","setDir","changeDir","FLOAT","hWaterSlowSpeed","Float","playFloatAni","FlashCatchStar","flashIndex","count","repeatTimes","frontSprite","behinSprite","front","active","opacity","isInvincible","isFlashing","getComponent","Sprite","behindSprite","delay","seq","updateFrame","repeat","frameNum","parseInt","spriteFrame","name","split","flashAtlas","getSpriteFrame","length","clearSubState","FlashCatchFlower","sprite","pauseSubState","setFormState","EM","emit","CHANGE_STATE","isPause","PAUSE_ACTOR","RESUME_ACTOR","resumeSubState","FlashCatchMonster","blinkOne","blink","blinkTwo","blinkThree","blinkFinished","ToBig","on","aniFinished","off","ToSmall","switchSubState","Die","stopAllActions","enableInput","enableCollsi","isDie","DIE","zIndex","playAni","y","callback","STOP_READTIME","Climb","CLIMB","getVSpeed","setCurrentTime","keyAPressed","keyDPressed","isTouchLand","resumeAni","pauseAni","w","isWPressed","size","getSize","x","isOnCirrus","fsm","gm","fixOffset","position","isCollsiFlag","module","exports"],"mappings":"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","file":"playerState.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\state","sourcesContent":["/*\r\n * @Description:马里奥所有状态\r\n * @Author: your name\r\n * @LastEditors: Please set LastEditors\r\n * @Date: 2019-03-02 11:27:38\r\n * @LastEditTime: 2019-03-30 17:46:49\r\n */\r\nvar State=require(\"state\");\r\n\r\n//站立状态\r\nvar Stand=cc.Class({\r\n    extends:State,\r\n    handleInput(input){\r\n        //按下k键跳跃\r\n        if(input.keyCode===cc.macro.KEY.k){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isKPressed){\r\n                    this.target.isKPressed=true;\r\n                    if(this.target.isOnWater){\r\n                        this._fsm.switchState(\"swim\");\r\n                    }else{\r\n                        this._fsm.switchState(\"jump\");\r\n                    }\r\n                    return;\r\n                }\r\n            }else{\r\n                this.target.isKPressed=false;\r\n            }\r\n        }\r\n\r\n        //按下a向左走\r\n        if(input.keyCode===cc.macro.KEY.a){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isAPressed){\r\n                    this.target.isAPressed=true;\r\n                    //this.target.setDir(DIR.DIR_LEFT);\r\n                    this.target.turnLeft();\r\n                    this._fsm.switchState(\"walk\");\r\n                    return;\r\n                }\r\n            }else{\r\n                this.target.isAPressed=false;\r\n            }\r\n        }\r\n\r\n        //按下d向右走\r\n        if(input.keyCode===cc.macro.KEY.d){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isDPressed){\r\n                    this.target.isDPressed=true;\r\n                    //this.target.setDir(DIR.DIR_RIGHT);\r\n                    this.target.turnRight();\r\n                    this._fsm.switchState(\"walk\");\r\n                    return;\r\n                }\r\n            }else{\r\n                this.target.isDPressed=false;\r\n            }\r\n        }\r\n\r\n\r\n        //s下蹲\r\n        if(input.keyCode===cc.macro.KEY.s){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isSPressed){\r\n                    this.target.isSPressed=true;\r\n                    if(this.target.getFormState()!==FORM_STATE.SMALL){\r\n                        this._fsm.switchState(\"squat\");\r\n                        return;\r\n                    }   \r\n                }\r\n            }else{\r\n                this.target.isSPressed=false;\r\n            }\r\n        }\r\n\r\n        //j键加速\r\n        if(input.keyCode===cc.macro.KEY.j){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isJPressed){\r\n                    this.target.isJPressed=true; \r\n                    if(this.target.getFormState()===FORM_STATE.FIRE){\r\n                        this.target.fire();\r\n                        return;\r\n                    } \r\n                }\r\n            }else{\r\n                this.target.isJPressed=false;\r\n            }\r\n        }\r\n    },\r\n    onEnter(){\r\n        this.target.setPlayerState(PLAYER_STATE.STAND);\r\n        this.target.hCurrAcceleration=0;\r\n        this.target.hCurrSpeed=0;\r\n        this.target.vCurrAcceleration=0;\r\n        this.target.vCurrSpeed=0;\r\n        this.playStandAni();\r\n    },\r\n    resume(){\r\n        this.onEnter();\r\n    },\r\n    playStandAni(){\r\n        switch(this.target.getFormState()){\r\n            case FORM_STATE.SMALL:this.target.animation.play(\"small_stand\");break;\r\n            case FORM_STATE.BIG:this.target.animation.play(\"big_stand\");break;\r\n            case FORM_STATE.FIRE:this.target.animation.play(\"fire_stand\");break;\r\n            default:break;\r\n        }\r\n    },\r\n    //进入fall\r\n    checkFallTransition(){\r\n        return !this.target.isOnLand;\r\n    },\r\n    update(dt){\r\n        if(this.checkFallTransition()){\r\n            this._fsm.switchState(\"fall\");\r\n            return;\r\n        }\r\n    }\r\n});\r\n\r\n//跳跃状态\r\nvar Jump=cc.Class({\r\n    extends:State,\r\n    ctor(){\r\n        this.orignDir=null;\r\n    },\r\n    handleInput(input){\r\n        //按下k键\r\n        if(input.keyCode===cc.macro.KEY.k){\r\n            if(input.type===\"keyup\"){\r\n                this.target.isKPressed=false;\r\n                this.target.vCurrAcceleration=this.target.vMaxAcceleration;\r\n            }else{\r\n                if(!this.target.isKPressed){\r\n                    this.target.isKPressed=true;\r\n                }\r\n            }\r\n        }\r\n        //按下d键\r\n        if(input.keyCode===cc.macro.KEY.d){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isDPressed){\r\n                    this.target.isDPressed=true;\r\n                    this.target.hCurrAcceleration=this.getAcceleration();\r\n                }\r\n            }else if(input.type===\"keyup\"){\r\n                this.target.isDPressed=false;\r\n                this.target.hCurrAcceleration=this.getAcceleration();\r\n            } \r\n        }\r\n        //按下a键\r\n        else if(input.keyCode===cc.macro.KEY.a){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isAPressed){\r\n                    this.target.isAPressed=true;\r\n                    this.target.hCurrAcceleration=this.getAcceleration();\r\n                }\r\n            }else if(input.type===\"keyup\"){\r\n                this.target.isAPressed=false;\r\n                this.target.hCurrAcceleration=this.getAcceleration();\r\n            }\r\n        }\r\n        //j键加速/发射子弹\r\n        if(input.keyCode===cc.macro.KEY.j){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isJPressed){\r\n                    this.target.isJPressed=true; \r\n                    if(this.target.getFormState()===FORM_STATE.FIRE){\r\n                        this.target.fire();\r\n                        return;\r\n                    } \r\n                }\r\n            }else{\r\n                this.target.isJPressed=false;\r\n            }\r\n        }\r\n    },\r\n    update(dt){\r\n        // if(Math.abs(this.target.vCurrSpeed)>this.target.vMaxSpeed){\r\n        //     this.target.vCurrAcceleration=0;\r\n        //     this.target.vCurrSpeed=this.target.vMaxSpeed*(Math.abs(this.target.vCurrSpeed)/this.target.vCurrSpeed);\r\n        // }\r\n\r\n        // if(Math.abs(this.target.hCurrSpeed)>this.target.hCurrMaxSpeed){\r\n        //     this.target.hCurrSpeed=this.target.hCurrMaxSpeed*(this.target.hCurrSpeed/Math.abs(this.target.hCurrSpeed));\r\n        //     this.target.hCurrAcceleration=0;\r\n        // }\r\n\r\n        if(this.checkStandTransition()){          \r\n            this._fsm.switchState(\"stand\");\r\n            return;\r\n        }\r\n\r\n        if(this.checkSlideTransition()){\r\n            this._fsm.switchState(\"slide\");\r\n            return;\r\n        }\r\n\r\n        if(this.checkWalkTransition()){\r\n            this._fsm.switchState(\"walk\");\r\n            return;\r\n        }\r\n\r\n        if(this.checkHStop()){\r\n            this.target.hCurrSpeed=0;\r\n            this.target.hCurrAcceleration=0;\r\n        }\r\n    },\r\n    onEnter(isReserveSpeed){\r\n        this.target.setPlayerState(PLAYER_STATE.JUMP);\r\n        this.target.isOnLand=false;\r\n        this.playJumpAni();\r\n        this.target.vCurrAcceleration=this.target.vMinAcceleration;\r\n        if(!isReserveSpeed){\r\n            this.target.vCurrSpeed=Math.abs(this.target.hCurrSpeed)>=this.target.hSpeMaxSpeed?this.target.vSpeOrignSpeed:this.target.vOrignSpeed;\r\n        }\r\n        this.target.hCurrAcceleration=this.getAcceleration();\r\n        this.target.hCurrMaxSpeed=this.getMaxSpeed();\r\n    },\r\n    onExit(){\r\n        this.target.vCurrAcceleration=0;\r\n        this.target.vCurrSpeed=0;\r\n        if(this.target.isAPressed){\r\n            this.target.turnLeft();\r\n        }else if(this.target.isDPressed){\r\n            this.target.turnRight();\r\n        }\r\n    },\r\n    playJumpAni(){\r\n        switch(this.target.getFormState()){\r\n            case FORM_STATE.SMALL:this.target.animation.play(\"small_jump\");break;\r\n            case FORM_STATE.BIG:this.target.animation.play(\"big_jump\");break;\r\n            case FORM_STATE.FIRE:this.target.animation.play(\"fire_jump\");break;\r\n            default:break;\r\n        }\r\n    },\r\n    getAcceleration(){\r\n        if(this.target.isAPressed){\r\n            return -this.target.hNorAcceleration;\r\n        }else if(this.target.isDPressed){\r\n            return this.target.hNorAcceleration;\r\n        }else if(this.target.hCurrSpeed<0){\r\n            return -this.target.hNorSlowAcceleration;\r\n        }else if(this.target.hCurrSpeed>0){\r\n            return this.target.hNorSlowAcceleration;\r\n        }else{\r\n            return 0;\r\n        }\r\n    },\r\n    getMaxSpeed(){\r\n        return this.target.isJPressed?this.target.hSpeMaxSpeed:this.target.hNorMaxSpeed;\r\n    },\r\n    //检查是否进入站立状态\r\n    checkStandTransition(){\r\n        return this.target.isOnLand&&this.target.hCurrSpeed===0;\r\n    },\r\n    //检查是否进入行走状态\r\n    checkWalkTransition(){\r\n        if(this.target.isOnLand&&this.target.hCurrSpeed!==0){\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    //检查水平方向是否停止运动\r\n    checkHStop(){\r\n        if((!this.target.isAPressed&&!this.target.isDPressed)\r\n        &&(this.target.hCurrSpeed*this.target.hCurrAcceleration>0)){\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    //检查是否进入滑行状态\r\n    checkSlideTransition(){\r\n        if(this.target.isOnLand){\r\n            if((this.target.hCurrSpeed<0&&this.target.isDPressed&&!this.target.isAPressed)\r\n            ||(this.target.hCurrSpeed>0&&!this.target.isDPressed&&this.target.isAPressed)){\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    resume(){\r\n        this.target.setPlayerState(PLAYER_STATE.JUMP);\r\n        this.playJumpAni();\r\n        this.target.hCurrAcceleration=this.getAcceleration();\r\n        this.target.hCurrMaxSpeed=this.getMaxSpeed();\r\n    }\r\n});\r\n\r\n//行走状态\r\nvar Walk=cc.Class({\r\n    extends:State,\r\n    ctor(){\r\n        this.animationState=null;\r\n        this.pauseDir=null;\r\n    },\r\n    handleInput(input){\r\n        if(input.keyCode===cc.macro.KEY.d){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isDPressed){\r\n                    this.target.isDPressed=true;\r\n                    this.target.turnRight();\r\n                    if(this.target.isOnWater){\r\n                        this.target.hCurrSpeed=0;\r\n                    }\r\n                    this.target.hCurrAcceleration=this.getAcceleration();\r\n                    this.target.hCurrMaxSpeed=this.getMaxSpeed();\r\n                }\r\n            }else if(input.type===\"keyup\"){\r\n                this.target.isDPressed=false;\r\n                this.target.hCurrAcceleration=this.getAcceleration();\r\n                if(this.target.isAPressed){\r\n                    this.target.turnLeft();\r\n                }\r\n            }\r\n            // if(this.checkSlideTransition()){\r\n            //     this._fsm.switchState(\"slide\");\r\n            //     return;\r\n            // }\r\n        }else if(input.keyCode===cc.macro.KEY.a){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isAPressed){\r\n                    this.target.isAPressed=true;\r\n                    this.target.turnLeft();\r\n                    if(this.target.isOnWater){\r\n                        this.target.hCurrSpeed=0;\r\n                    }\r\n                    this.target.hCurrAcceleration=this.getAcceleration();\r\n                    this.target.hCurrMaxSpeed=this.getMaxSpeed();\r\n                }\r\n            }else if(input.type===\"keyup\"){\r\n                this.target.isAPressed=false;\r\n                this.target.hCurrAcceleration=this.getAcceleration();\r\n                if(this.target.isDPressed){\r\n                    this.target.turnRight();\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        //按下k键跳跃\r\n        if(cc.macro.KEY.k===input.keyCode){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isKPressed){\r\n                    this.target.isKPressed=true;\r\n                    if(this.target.isOnWater){\r\n                        this._fsm.switchState(\"swim\");\r\n                    }else{\r\n                        this._fsm.switchState(\"jump\");\r\n                    }\r\n                    return;\r\n                }\r\n            }else if(input.type===\"keyup\"){\r\n                this.target.isKPressed=false;\r\n            }   \r\n        }\r\n\r\n        //s下蹲\r\n        if(input.keyCode===cc.macro.KEY.s){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isSPressed){\r\n                    this.target.isSPressed=true;\r\n                    if(this.target.getFormState()!==FORM_STATE.SMALL){\r\n                        this._fsm.switchState(\"squat\");\r\n                    }   \r\n                }\r\n            }else{\r\n                this.target.isSPressed=false;\r\n            }\r\n        }\r\n\r\n        //j键加速\r\n        if(input.keyCode===cc.macro.KEY.j){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isJPressed){\r\n                    this.target.isJPressed=true; \r\n                    if(this.target.getFormState()===FORM_STATE.FIRE){\r\n                        this.target.fire();\r\n                        return;\r\n                    } \r\n                    this.target.hCurrAcceleration=this.getAcceleration();\r\n                    this.target.hCurrMaxSpeed=this.getMaxSpeed();\r\n                    this.updateAniSpeed();\r\n                }\r\n            }else{\r\n                this.target.isJPressed=false;\r\n                this.target.hCurrAcceleration=this.getAcceleration();\r\n                this.target.hCurrMaxSpeed=this.getMaxSpeed();\r\n                this.updateAniSpeed();\r\n            }\r\n        }\r\n    },\r\n    update(dt){\r\n\r\n        // if(Math.abs(this.target.hCurrSpeed)>Math.abs(this.target.hCurrMaxSpeed)){\r\n        //     this.target.hCurrSpeed=this.target.hCurrMaxSpeed*(this.target.hCurrSpeed/Math.abs(this.target.hCurrSpeed));\r\n        //     this.target.hCurrAcceleration=0;\r\n        // }\r\n\r\n        if(this.checkSlideTransition()){\r\n            this._fsm.switchState(\"slide\");\r\n            return;\r\n        }\r\n\r\n        if(this.checkStandTransition()){\r\n            this._fsm.switchState(\"stand\");\r\n            return;\r\n        }\r\n\r\n        if(this.checkFallTransition()){\r\n            this._fsm.switchState(\"fall\");\r\n            return;\r\n        }\r\n\r\n    },\r\n    onEnter(){ \r\n        this.target.isOnLand=true;   \r\n        this.target.setPlayerState(PLAYER_STATE.WALK);\r\n        this.target.hCurrAcceleration=this.getAcceleration();\r\n        this.target.hCurrMaxSpeed=this.getMaxSpeed();\r\n        this.animationState=this.playWalkAni();\r\n        this.target.vCurrAcceleration=0;\r\n        this.target.vCurrSpeed=0;\r\n        this.updateAniSpeed();\r\n    },\r\n    playWalkAni(){\r\n        switch(this.target.getFormState()){\r\n            case FORM_STATE.SMALL:return this.target.animation.play(\"small_walk\");\r\n            case FORM_STATE.BIG:return this.target.animation.play(\"big_walk\");\r\n            case FORM_STATE.FIRE:return this.target.animation.play(\"fire_walk\");\r\n            default:break;\r\n        }\r\n    },\r\n    getAcceleration(){\r\n        if(this.target.isAPressed){\r\n            if(this.target.isOnWater){\r\n                return -this.target.hWaterAcceleration;\r\n            }\r\n            return this.target.isJPressed?-this.target.hSpeAcceleration:-this.target.hNorAcceleration;\r\n        }else if(this.target.isDPressed){\r\n            if(this.target.isOnWater){\r\n                return this.target.hWaterAcceleration;\r\n            }\r\n            return this.target.isJPressed?this.target.hSpeAcceleration:this.target.hNorAcceleration;\r\n        }else if(this.target.dir===DIR.DIR_LEFT){\r\n            return -this.target.hNorSlowAcceleration;\r\n        }else{\r\n            return this.target.hNorSlowAcceleration;\r\n        }\r\n    },\r\n    getMaxSpeed(){\r\n        if(this.target.isOnWater){\r\n            return this.target.hWaterMaxSpeed;\r\n        }\r\n        return this.target.isJPressed?this.target.hSpeMaxSpeed:this.target.hNorMaxSpeed;\r\n    },\r\n    //检查是否进入滑行状态\r\n    checkSlideTransition(){\r\n        if((this.target.hCurrSpeed<0&&this.target.isDPressed&&!this.target.isAPressed)\r\n            ||(this.target.hCurrSpeed>0&&!this.target.isDPressed&&this.target.isAPressed)){\r\n                if(this.target.isOnWater){\r\n                    return false;\r\n                }\r\n                return true;\r\n        }\r\n        return false;\r\n    },\r\n    //检测是否进入站立状态\r\n    checkStandTransition(){\r\n        if((!this.target.isAPressed&&!this.target.isDPressed)\r\n        &&((this.target.hCurrSpeed>0&&this.target.dir===DIR.DIR_LEFT)||(this.target.hCurrSpeed<0&&this.target.dir===DIR.DIR_RIGHT))){\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    //进入fall\r\n    checkFallTransition(){\r\n        return !this.target.isOnLand;\r\n    },\r\n    updateAniSpeed(){\r\n        if(this.target.isOnWater)return;\r\n        this.target.isJPressed?this.animationState.speed=2:this.animationState.speed=1;\r\n    },\r\n    pause(){\r\n        //this.pauseDir=this.target.getDir();\r\n    },\r\n    resume(){\r\n        //this.target.setDir(this.pauseDir);  \r\n        if(this.target.isAPressed)this.target.turnLeft();\r\n        else if(this.target.isDPressed)this.target.turnRight();\r\n        this.target.setPlayerState(PLAYER_STATE.WALK);\r\n        this.target.hCurrAcceleration=this.getAcceleration();\r\n        this.target.hCurrMaxSpeed=this.getMaxSpeed();\r\n        this.animationState=this.playWalkAni();\r\n        this.updateAniSpeed();\r\n    }\r\n});\r\n\r\n//滑行状态\r\nvar Slide=cc.Class({\r\n    extends:State,\r\n    handleInput(input){\r\n        if(input.keyCode===cc.macro.KEY.d){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isDPressed){\r\n                    this.target.isDPressed=true;\r\n                    this.target.turnRight();\r\n                }\r\n            }else if(input.type===\"keyup\"){\r\n                this.target.isDPressed=false;\r\n            }\r\n        }else if(input.keyCode===cc.macro.KEY.a){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isAPressed){\r\n                    this.target.isAPressed=true;\r\n                    this.target.turnLeft();\r\n                }\r\n            }else if(input.type===\"keyup\"){\r\n                this.target.isAPressed=false;\r\n            }\r\n        }\r\n        //按下k键跳跃\r\n        if(cc.macro.KEY.k===input.keyCode){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isKPressed){\r\n                    this.target.isKPressed=true;\r\n                    this._fsm.switchState(\"jump\");\r\n                }\r\n            }else if(input.type===\"keyup\"){\r\n                this.target.isKPressed=false;\r\n            }   \r\n        }\r\n\r\n        //s下蹲\r\n        if(input.keyCode===cc.macro.KEY.s){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isSPressed){\r\n                    this.target.isSPressed=true;\r\n                    if(this.target.getFormState()!==FORM_STATE.SMALL){\r\n                        this._fsm.switchState(\"squat\");\r\n                    }   \r\n                }\r\n            }else{\r\n                this.target.isSPressed=false;\r\n            }\r\n        }\r\n    },\r\n    onEnter(){  \r\n        this.target.isOnLand=true;\r\n        this.target.setPlayerState(PLAYER_STATE.SLIDE);\r\n        this.target.hCurrAcceleration=this.getAcceleration();\r\n        this.playSlideAni();\r\n    },\r\n    pause(){\r\n        this.target.dir===DIR.DIR_LEFT?this.target.node.scaleX=-1:this.target.node.scaleX=1;\r\n    },\r\n    resume(){\r\n        this.onEnter();\r\n    },\r\n    onExit(){\r\n        this.target.dir===DIR.DIR_LEFT?this.target.node.scaleX=-1:this.target.node.scaleX=1;\r\n    },\r\n    playSlideAni(){\r\n        this.target.dir===DIR.DIR_LEFT?this.target.node.scaleX=1:this.target.node.scaleX=-1;\r\n        switch(this.target.getFormState()){\r\n            case FORM_STATE.SMALL:this.target.animation.play(\"small_slide\");break;\r\n            case FORM_STATE.BIG:this.target.animation.play(\"big_slide\");break;\r\n            case FORM_STATE.FIRE:this.target.animation.play(\"fire_slide\");break;\r\n            default:break;\r\n        }\r\n    },\r\n    getAcceleration(){\r\n        return this.target.dir===DIR.DIR_LEFT?this.target.hSpeSlowAcceleration:-this.target.hSpeSlowAcceleration;\r\n    },\r\n    ///检查是否进入行走状态\r\n    checkWalkTransition(){\r\n        if((this.target.hCurrSpeed<0&&this.target.isAPressed)\r\n        ||(this.target.hCurrSpeed>0&&this.target.isDPressed)){\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    //是否进入站立状态\r\n    checkStandTransition(){\r\n        if((!this.target.isAPressed&&!this.target.isDPressed)\r\n        &&((this.target.hCurrSpeed<0&&this.target.dir===DIR.DIR_LEFT)||(this.target.hCurrSpeed>0&&this.target.dir===DIR.DIR_RIGHT))){\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    //进入fall\r\n    checkFallTransition(){\r\n        return !this.target.isOnLand;\r\n    },\r\n    update(dt){\r\n        //是否进入行走状态\r\n        if(this.checkWalkTransition()){\r\n            this._fsm.switchState(\"walk\");\r\n            return;\r\n        }\r\n\r\n        //是否进入站立状态\r\n        if(this.checkStandTransition()){\r\n            this._fsm.switchState(\"stand\");\r\n            return;\r\n        }\r\n\r\n        if(this.checkFallTransition()){\r\n            this._fsm.switchState(\"fall\");\r\n            return;\r\n        }\r\n    }\r\n\r\n});\r\n\r\n\r\n//下蹲状态\r\n\r\nvar Squat=cc.Class({\r\n    extends:State,\r\n    ctor(){\r\n        this.isOnSky=false;\r\n        this.orignSpeed=null;\r\n    },\r\n    onEnter(){\r\n        this.isOnSky=false;\r\n        this.orignSpeed=this.target.hCurrSpeed;\r\n        this.target.hCurrAcceleration=this.getAcceleration();\r\n        this.target.setPlayerState(PLAYER_STATE.SQUAT);\r\n        this.playSquatAni();\r\n    },\r\n    handleInput(input){\r\n\r\n        //按下k键\r\n        if(input.keyCode===cc.macro.KEY.k){\r\n            if(input.type===\"keyup\"){\r\n                this.target.isKPressed=false;\r\n                this.target.vCurrAcceleration=this.target.vMaxAcceleration;\r\n            }else{\r\n                if(!this.target.isKPressed){\r\n                    this.target.isKPressed=true;\r\n                    if(!this.isOnSky&&!this.target.isOnWater){\r\n                        this.isOnSky=true;\r\n                        this.target.vCurrAcceleration=this.target.vMinAcceleration;\r\n                        this.target.vCurrSpeed=this.target.vOrignSpeed;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        if(input.keyCode===cc.macro.KEY.s){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isSPressed){\r\n                    this.target.isSPressed=true;\r\n                }\r\n            }else{\r\n                this.target.isSPressed=false;\r\n                if(this.isOnSky){\r\n                    this._fsm.switchState(\"jump\",true);\r\n                }else{\r\n                    this._fsm.switchState(\"stand\");\r\n                }        \r\n            }\r\n        }\r\n\r\n    },\r\n    playSquatAni(){\r\n        switch(this.target.getFormState()){\r\n            case FORM_STATE.SMALL:this.target.animation.play(\"small_stand\");break;\r\n            case FORM_STATE.BIG:this.target.animation.play(\"big_squat\");break;\r\n            case FORM_STATE.FIRE:this.target.animation.play(\"fire_squat\");break;\r\n            default:break;\r\n        }\r\n    },\r\n    update(dt){\r\n        if(this.checkVStop()){\r\n            this.target.vCurrAcceleration=0;\r\n            this.target.vCurrSpeed=0;\r\n            this.isOnSky=false;\r\n        }\r\n\r\n        if(this.checkHStop()){\r\n            this.target.hCurrSpeed=0;\r\n            this.target.hCurrAcceleration=0;\r\n        }\r\n\r\n        if(this.checkFallTransition()){\r\n            this._fsm.switchState(\"fall\");\r\n            return;\r\n        }\r\n    },\r\n    getAcceleration(){\r\n        if(this.target.hCurrSpeed>0){\r\n            return this.target.hNorSlowAcceleration;\r\n        }else if(this.target.hCurrSpeed<0){\r\n            return -this.target.hNorSlowAcceleration;\r\n        }else{\r\n            return 0;\r\n        }\r\n    },\r\n    checkHStop(){\r\n        if(this.target.hCurrSpeed*this.orignSpeed<0){\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    checkVStop(){\r\n        return this.target.isOnLand&&this.isOnSky;\r\n    },\r\n    //进入fall\r\n    checkFallTransition(){\r\n        return !this.target.isOnLand&&!this.isOnSky;\r\n    },\r\n    resume(){\r\n        //cc.log(\"onenter\")\r\n        this.target.hCurrAcceleration=this.getAcceleration();\r\n        this.target.setPlayerState(PLAYER_STATE.SQUAT);\r\n        this.playSquatAni();\r\n    }\r\n});\r\n\r\n//发射子弹\r\nvar Fire=cc.Class({\r\n    extends:State,\r\n    ctor(){\r\n        this.interval=0;\r\n        this.id=null;\r\n    },\r\n    handleInput(input){\r\n\r\n    },\r\n    onEnter(){\r\n        this.target.setPlayerState(PLAYER_STATE.FIRE);\r\n        this.playFireAni();\r\n        //100ms后恢复原来的状态\r\n        this.target.behind.runAction(cc.sequence(cc.delayTime(0.08),cc.callFunc(function(){\r\n            this._fsm.switchPreState();\r\n        },this)));\r\n    },\r\n    playFireAni(){\r\n        if(this.target.isOnWater){\r\n            this.target.animation.play(\"fire_fire_water\");\r\n        }else{\r\n            this.target.animation.play(\"fire_fire\");\r\n        }\r\n    },\r\n    pause(){\r\n        this.target.behind.pauseAllActions();\r\n    },\r\n    resume(){\r\n        this.target.behind.resumeAllActions();\r\n    }\r\n});\r\n\r\n//下落状态\r\nvar Fall=cc.Class({\r\n    extends:State,\r\n    ctor(){\r\n        this.orignDir=null;\r\n    },\r\n    onEnter(){\r\n        this.target.setPlayerState(PLAYER_STATE.FALL);\r\n        this.target.vCurrSpeed=0;\r\n        this.target.vCurrAcceleration=this.target.vMaxAcceleration;\r\n        this.playFallAni();\r\n        this.target.hCurrAcceleration=this.getAcceleration();\r\n        this.target.hCurrMaxSpeed=this.getMaxSpeed();\r\n    },\r\n    handleInput(input){\r\n\r\n        //按下d键\r\n        if(input.keyCode===cc.macro.KEY.d){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isDPressed){\r\n                    this.target.isDPressed=true;\r\n                    this.target.hCurrAcceleration=this.getAcceleration();\r\n                }\r\n            }else if(input.type===\"keyup\"){\r\n                this.target.isDPressed=false;\r\n                this.target.hCurrAcceleration=this.getAcceleration();\r\n            } \r\n        }\r\n        //按下a键\r\n        else if(input.keyCode===cc.macro.KEY.a){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isAPressed){\r\n                    this.target.isAPressed=true;\r\n                    this.target.hCurrAcceleration=this.getAcceleration();\r\n                }\r\n            }else if(input.type===\"keyup\"){\r\n                this.target.isAPressed=false;\r\n                this.target.hCurrAcceleration=this.getAcceleration();\r\n            }\r\n        }\r\n        //j键加速/发射子弹\r\n        if(input.keyCode===cc.macro.KEY.j){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isJPressed){\r\n                    this.target.isJPressed=true; \r\n                    if(this.target.getFormState()===FORM_STATE.FIRE){\r\n                        this.target.fire();\r\n                        return;\r\n                    } \r\n                }\r\n            }else{\r\n                this.target.isJPressed=false;\r\n            }\r\n        }\r\n    },\r\n    update(dt){\r\n\r\n        if(this.checkStandTransition()){\r\n            this._fsm.switchState(\"stand\");\r\n            return;\r\n        }\r\n\r\n        if(this.checkSlideTransition()){\r\n            this._fsm.switchState(\"slide\");\r\n            return;\r\n        }\r\n\r\n        if(this.checkWalkTransition()){\r\n            this._fsm.switchState(\"walk\");\r\n            return;\r\n        }\r\n\r\n        if(this.checkHStop()){\r\n            this.target.hCurrSpeed=0;\r\n            this.target.hCurrAcceleration=0;\r\n        }\r\n    },\r\n    playFallAni(){\r\n        if(this.target.dir===DIR.DIR_RIGHT){\r\n            this.target.turnRight();\r\n        }else{\r\n            this.target.turnLeft();\r\n        }\r\n        switch(this.target.getFormState()){\r\n            case FORM_STATE.SMALL:this.target.animation.play(\"small_fall\");break;\r\n            case FORM_STATE.BIG:this.target.animation.play(\"big_fall\");break;\r\n            case FORM_STATE.FIRE:this.target.animation.play(\"fire_fall\");break;\r\n            default:break;\r\n        }\r\n    },\r\n    getAcceleration(){\r\n        if(this.target.isAPressed){\r\n            return -this.target.hNorAcceleration;\r\n        }else if(this.target.isDPressed){\r\n            return this.target.hNorAcceleration;\r\n        }else if(this.target.hCurrSpeed<0){\r\n            return -this.target.hNorSlowAcceleration;\r\n        }else if(this.target.hCurrSpeed>0){\r\n            return this.target.hNorSlowAcceleration;\r\n        }else{\r\n            return 0;\r\n        }\r\n    },\r\n    getMaxSpeed(){\r\n        return this.target.isJPressed?this.target.hSpeMaxSpeed:this.target.hNorMaxSpeed;\r\n    },\r\n    //检查是否进入站立状态\r\n    checkStandTransition(){\r\n        return this.target.isOnLand&&this.target.hCurrSpeed===0;\r\n    },\r\n    //检查是否进入行走状态\r\n    checkWalkTransition(){\r\n        return this.target.isOnLand&&this.target.hCurrSpeed!==0;\r\n    },\r\n    //检查水平方向是否停止运动\r\n    checkHStop(){\r\n        if((!this.target.isAPressed&&!this.target.isDPressed)\r\n        &&(this.target.hCurrSpeed*this.target.hCurrAcceleration>0)){\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    //检查是否进入滑行状态\r\n    checkSlideTransition(){\r\n        if(this.target.isOnLand){\r\n            if((this.target.hCurrSpeed<0&&this.target.isDPressed&&!this.target.isAPressed)\r\n            ||(this.target.hCurrSpeed>0&&!this.target.isDPressed&&this.target.isAPressed)){\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    resume(){\r\n        this.target.setPlayerState(PLAYER_STATE.FALL);\r\n        this.playFallAni();\r\n    },\r\n    onExit(){\r\n        this.target.vCurrAcceleration=0;\r\n        this.target.vCurrSpeed=0;\r\n        if(this.target.isAPressed){\r\n            this.target.turnLeft();\r\n        }else if(this.target.isDPressed){\r\n            this.target.turnRight();\r\n        }\r\n    },\r\n});\r\n\r\n//游泳\r\nvar Swim=cc.Class({\r\n    extends:State,\r\n    ctor(){\r\n        this.animationState=null;\r\n    },\r\n    update(){\r\n        if(this.checkStandTransition()){\r\n            this._fsm.switchState(\"stand\");\r\n            return;\r\n        }\r\n\r\n        //动画播放完成进入float\r\n        if(!this.animationState.isPlaying){\r\n            this._fsm.switchState(\"float\");\r\n            return;\r\n        }\r\n\r\n        if(this.checkWalkTransition()){\r\n            this._fsm.switchState(\"walk\");\r\n            return;\r\n        }\r\n        \r\n        if(this.checkHStop()){\r\n            this.target.hCurrAcceleration=0;\r\n            this.target.hCurrSpeed=0;\r\n        }\r\n    },\r\n    handleInput(input){\r\n        //k\r\n        if(input.keyCode===cc.macro.KEY.k){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isKPressed){\r\n                    this.target.isKPressed=true; \r\n                    this.target.vCurrAcceleration=this.target.vWaterMinAcceleration;\r\n                    this.target.vCurrSpeed=this.target.vWaterOrignSpeed;\r\n                    this.animationState=this.playSwinAni();\r\n                }\r\n            }else{\r\n                this.target.isKPressed=false;\r\n            }\r\n        }\r\n\r\n        //a/d\r\n        if(input.keyCode===cc.macro.KEY.d){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isDPressed){\r\n                    this.target.isDPressed=true;\r\n                    this.target.setDir(DIR.DIR_RIGHT);\r\n                    this.changeDir();\r\n                    this.target.hCurrAcceleration=this.getAcceleration();\r\n                    this.target.hCurrMaxSpeed=this.getMaxSpeed();\r\n                }\r\n            }else if(input.type===\"keyup\"){\r\n                this.target.isDPressed=false;\r\n                this.target.hCurrAcceleration=this.getAcceleration();\r\n                if(this.target.isAPressed){\r\n                    this.target.setDir(DIR.DIR_LEFT);\r\n                    this.changeDir();\r\n                }\r\n            }\r\n        }else if(input.keyCode===cc.macro.KEY.a){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isAPressed){\r\n                    this.target.isAPressed=true;\r\n                    this.target.setDir(DIR.DIR_LEFT);\r\n                    this.changeDir();\r\n                    this.target.hCurrAcceleration=this.getAcceleration();\r\n                    this.target.hCurrMaxSpeed=this.getMaxSpeed();\r\n                }\r\n            }else if(input.type===\"keyup\"){\r\n                this.target.isAPressed=false;\r\n                this.target.hCurrAcceleration=this.getAcceleration();\r\n                if(this.target.isDPressed){\r\n                    this.target.setDir(DIR.DIR_RIGHT);\r\n                    this.changeDir();\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        //j键加速\r\n        if(input.keyCode===cc.macro.KEY.j){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isJPressed){\r\n                    this.target.isJPressed=true; \r\n                    if(this.target.getFormState()===FORM_STATE.FIRE){\r\n                        this.target.fire();\r\n                    } \r\n                }\r\n            }else{\r\n                this.target.isJPressed=false;\r\n            }\r\n        }\r\n    },\r\n    onEnter(){\r\n        this.target.setPlayerState(PLAYER_STATE.FLOAT);\r\n        this.target.vCurrAcceleration=this.target.vWaterMinAcceleration;\r\n        this.target.vCurrSpeed=this.target.vWaterOrignSpeed;\r\n        this.animationState=this.playSwinAni();\r\n    },\r\n    playSwinAni(){\r\n        this.changeDir();\r\n        switch(this.target.getFormState()){\r\n            case FORM_STATE.SMALL:return this.target.animation.play(\"small_swim\");\r\n            case FORM_STATE.BIG:return this.target.animation.play(\"big_swim\");\r\n            case FORM_STATE.FIRE:return this.target.animation.play(\"fire_swim\");\r\n            default:break;\r\n        }\r\n    },\r\n    //检查是否进入站立状态\r\n    checkStandTransition(){\r\n        return this.target.isOnLand&&this.target.hCurrSpeed===0;\r\n    },\r\n    changeDir(){\r\n        if(this.target.dir===DIR.DIR_LEFT){\r\n            this.target.turnLeft();\r\n        }else{\r\n            this.target.turnRight();\r\n        }\r\n    },\r\n    getAcceleration(){\r\n        if(this.target.isAPressed){\r\n            return -this.target.hNorAcceleration;\r\n        }else if(this.target.isDPressed){\r\n            return this.target.hNorAcceleration;\r\n        }else if(this.target.dir===DIR.DIR_LEFT){\r\n            return -this.target.hWaterSlowSpeed;\r\n        }else{\r\n            return this.target.hWaterSlowSpeed;\r\n        }\r\n    },\r\n    getMaxSpeed(){\r\n        return this.target.hNorMaxSpeed;\r\n    },\r\n    //检查水平方向是否停止运动\r\n    checkHStop(){\r\n        if((!this.target.isAPressed&&!this.target.isDPressed)\r\n        &&((this.target.hCurrSpeed>0&&this.target.dir===DIR.DIR_LEFT)||(this.target.hCurrSpeed<0&&this.target.dir===DIR.DIR_RIGHT))){\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    //检查是否进入行走状态\r\n    checkWalkTransition(){\r\n        return this.target.isOnLand&&this.target.hCurrSpeed!==0;\r\n    }\r\n});\r\n\r\n\r\n//浮水\r\n\r\nvar Float=cc.Class({\r\n    extends:State,\r\n    ctor(){\r\n\r\n    },\r\n    update(){\r\n        if(this.checkStandTransition()){\r\n            this._fsm.switchState(\"stand\");\r\n            return;\r\n        }\r\n\r\n        if(this.checkWalkTransition()){\r\n            this._fsm.switchState(\"walk\");\r\n            return;\r\n        }\r\n\r\n        if(this.checkHStop()){\r\n            this.target.hCurrAcceleration=0;\r\n            this.target.hCurrSpeed=0;\r\n        }\r\n    },\r\n    handleInput(input){\r\n        //k\r\n        if(input.keyCode===cc.macro.KEY.k){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isKPressed){\r\n                    this.target.isKPressed=true; \r\n                    this._fsm.switchState(\"swim\");\r\n                }\r\n            }else{\r\n                this.target.isKPressed=false;\r\n            }\r\n        }\r\n        //a/d\r\n        if(input.keyCode===cc.macro.KEY.d){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isDPressed){\r\n                    this.target.isDPressed=true;\r\n                    this.target.setDir(DIR.DIR_RIGHT);\r\n                    this.playFloatAni();\r\n                    this.target.hCurrAcceleration=this.getAcceleration();\r\n                    this.target.hCurrMaxSpeed=this.getMaxSpeed();\r\n                }\r\n            }else if(input.type===\"keyup\"){\r\n                this.target.isDPressed=false;\r\n                this.target.hCurrAcceleration=this.getAcceleration();\r\n                if(this.target.isAPressed){\r\n                    this.target.setDir(DIR.DIR_LEFT);\r\n                    this.playFloatAni();\r\n                }\r\n            }\r\n        }else if(input.keyCode===cc.macro.KEY.a){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isAPressed){\r\n                    this.target.isAPressed=true;\r\n                    this.target.setDir(DIR.DIR_LEFT);\r\n                    this.playFloatAni();\r\n                    this.target.hCurrAcceleration=this.getAcceleration();\r\n                    this.target.hCurrMaxSpeed=this.getMaxSpeed();\r\n                }\r\n            }else if(input.type===\"keyup\"){\r\n                this.target.isAPressed=false;\r\n                this.target.hCurrAcceleration=this.getAcceleration();\r\n                if(this.target.isDPressed){\r\n                    this.target.setDir(DIR.DIR_RIGHT);\r\n                    this.playFloatAni();\r\n                }\r\n            }\r\n        }\r\n\r\n        //        //j键加速\r\n        if(input.keyCode===cc.macro.KEY.j){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isJPressed){\r\n                    this.target.isJPressed=true; \r\n                    if(this.target.getFormState()===FORM_STATE.FIRE){\r\n                        this.target.fire();\r\n                    } \r\n                }\r\n            }else{\r\n                this.target.isJPressed=false;\r\n            }\r\n        }\r\n\r\n    },\r\n    onEnter(){\r\n        this.target.hCurrAcceleration=this.getAcceleration();\r\n        this.target.hCurrMaxSpeed=this.getMaxSpeed();\r\n        this.target.setPlayerState(PLAYER_STATE.FLOAT);\r\n        this.playFloatAni();\r\n    },\r\n    playFloatAni(){\r\n        if(this.target.dir===DIR.DIR_RIGHT){\r\n            this.target.turnRight();\r\n        }else{\r\n            this.target.turnLeft();\r\n        }\r\n        switch(this.target.getFormState()){\r\n            case FORM_STATE.SMALL:this.target.animation.play(\"small_float\");break;\r\n            case FORM_STATE.BIG:this.target.animation.play(\"big_float\");break;\r\n            case FORM_STATE.FIRE:this.target.animation.play(\"fire_float\");break;\r\n            default:break;\r\n        }\r\n    },\r\n    //检查是否进入站立状态\r\n    checkStandTransition(){\r\n        return this.target.isOnLand&&this.target.hCurrSpeed===0;\r\n    },\r\n    //检查是否进入行走状态\r\n    checkWalkTransition(){\r\n        return this.target.isOnLand&&this.target.hCurrSpeed!==0;\r\n    },\r\n    getAcceleration(){\r\n        if(this.target.isAPressed){\r\n            return -this.target.hNorAcceleration;\r\n        }else if(this.target.isDPressed){\r\n            return this.target.hNorAcceleration;\r\n        }else if(this.target.dir===DIR.DIR_LEFT){\r\n            return -this.target.hWaterSlowSpeed;\r\n        }else{\r\n            return this.target.hWaterSlowSpeed;\r\n        }\r\n    },\r\n    getMaxSpeed(){\r\n        return this.target.hNorMaxSpeed;\r\n    },\r\n    //检查水平方向是否停止运动\r\n    checkHStop(){\r\n        if((!this.target.isAPressed&&!this.target.isDPressed)\r\n        &&((this.target.hCurrSpeed>0&&this.target.dir===DIR.DIR_LEFT)||(this.target.hCurrSpeed<0&&this.target.dir===DIR.DIR_RIGHT))){\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n});\r\n\r\n\r\n//遇到星星之后的闪烁\r\nvar FlashCatchStar =cc.Class({\r\n    extends:State,\r\n    ctor(){\r\n        this.flashIndex=null;\r\n        this.count=0;\r\n        this.repeatTimes=160;\r\n        this.frontSprite=null;\r\n        this.behinSprite=null;\r\n    },  \r\n    onEnter(){\r\n\r\n        this.flashIndex=0;\r\n        this.count=0;\r\n        this.target.front.active=true;\r\n        this.target.behind.opacity=0;\r\n        this.target.isInvincible=true;\r\n        this.target.isFlashing=true;\r\n        this.frontSprite=this.target.front.getComponent(cc.Sprite);\r\n        this.behindSprite=this.target.behind.getComponent(cc.Sprite);\r\n        \r\n\r\n        let delay=cc.delayTime(0.05);\r\n        let seq=cc.sequence(delay,cc.callFunc(this.updateFrame,this));    \r\n        let repeat=cc.repeat(seq,this.repeatTimes);\r\n        this.target.behind.runAction(repeat);\r\n\r\n    },\r\n    updateFrame(){\r\n        let frameNum=parseInt(this.behindSprite.spriteFrame.name.split(\"_\")[1]);;\r\n        this.frontSprite.spriteFrame=this.target.flashAtlas[this.flashIndex++].getSpriteFrame(\"flash_\"+frameNum);\r\n        this.flashIndex%=this.target.flashAtlas.length;\r\n        this.count++;\r\n     \r\n        if(this.count>=this.repeatTimes){\r\n            this._fsm.clearSubState();\r\n        }\r\n    },\r\n    pause(){\r\n        this.target.front.active=false;\r\n        this.target.behind.opacity=255;\r\n        this.target.behind.pauseAllActions();\r\n    },\r\n    resume(){\r\n        this.target.front.active=true;\r\n        this.target.behind.opacity=0;\r\n        this.target.behind.resumeAllActions();\r\n    },\r\n    onExit(){\r\n        this.target.isFlashing=false;\r\n        this.target.front.active=false;\r\n        this.target.behind.opacity=255;\r\n        this.target.isInvincible=false;\r\n    }\r\n});\r\n\r\n\r\n//遇到花朵之后的闪烁\r\nvar FlashCatchFlower=cc.Class({\r\n    extends:State,\r\n    ctor(){\r\n        this.flashIndex=null;\r\n        this.frameNum=null;\r\n        this.count=0;\r\n        this.repeatTimes=10;\r\n        this.sprite=null;\r\n    },  \r\n    onEnter(){\r\n        //清除子状态\r\n        this._fsm.pauseSubState();\r\n\r\n        this.flashIndex=0;\r\n        this.count=0;\r\n        this.target.front.active=true;\r\n        this.target.behind.active=false;\r\n\r\n        this.sprite=this.target.front.getComponent(cc.Sprite);\r\n        let sprite=this.target.behind.getComponent(cc.Sprite);\r\n        this.frameNum=parseInt(sprite.spriteFrame.name.split(\"_\")[1]);\r\n        this.target.setFormState(FORM_STATE.FIRE);\r\n        EM.emit(EM.type.CHANGE_STATE,FORM_STATE.FIRE);\r\n\r\n        let delay=cc.delayTime(0.1);\r\n        let seq=cc.sequence(delay,cc.callFunc(this.updateFrame,this));        \r\n        let repeat=cc.repeat(seq,this.repeatTimes);\r\n        this.target.node.runAction(repeat);\r\n        this.target.isPause=true;\r\n        EM.emit(EM.type.PAUSE_ACTOR);\r\n    },\r\n    updateFrame(){\r\n        this.sprite.spriteFrame=this.target.flashAtlas[this.flashIndex++].getSpriteFrame(\"flash_\"+this.frameNum);\r\n        this.flashIndex%=this.target.flashAtlas.length;\r\n        this.count++;     \r\n        if(this.count>=this.repeatTimes){\r\n            this.target.front.active=false;\r\n            this.target.behind.active=true;\r\n            this._fsm.switchPreState();\r\n        }\r\n    },\r\n    onExit(){\r\n        this.target.isPause=false;\r\n        EM.emit(EM.type.RESUME_ACTOR);\r\n        this._fsm.resumeSubState();\r\n    }\r\n});\r\n\r\n\r\n//遇到怪物之后的闪烁\r\nvar FlashCatchMonster=cc.Class({\r\n    extends:State,\r\n    onEnter(){\r\n        let blinkOne=cc.blink(3,40);\r\n        let blinkTwo=cc.blink(2,16);\r\n        let blinkThree=cc.blink(1,6);\r\n        let seq=cc.sequence(blinkOne,blinkTwo,blinkThree,cc.callFunc(this.blinkFinished,this));\r\n        this.target.isInvincible=true;\r\n        this.target.node.runAction(seq);\r\n    },  \r\n    blinkFinished(){\r\n        this.target.isInvincible=false;\r\n        this._fsm.clearSubState();\r\n    },\r\n    pause(){\r\n        this.target.node.pauseAllActions();\r\n        this.target.node.opacity=255;\r\n    },\r\n    resume(){\r\n        this.target.node.resumeAllActions();\r\n    }\r\n});\r\n\r\n\r\n//变大\r\nvar ToBig=cc.Class({\r\n    extends:State,\r\n    onEnter(){\r\n        this._fsm.pauseSubState();\r\n\r\n        this.target.animation.play(\"to_big\");    \r\n        this.target.animation.on(\"finished\",this.aniFinished,this);\r\n        this.target.isPause=true;\r\n        EM.emit(EM.type.PAUSE_ACTOR);\r\n        EM.emit(EM.type.CHANGE_STATE,FORM_STATE.BIG);\r\n    },\r\n    aniFinished(){\r\n        this.target.setFormState(FORM_STATE.BIG);\r\n        this._fsm.switchPreState();\r\n    },\r\n    onExit(){\r\n        this.target.animation.off(\"finished\",this.aniFinished,this);\r\n        this.target.isPause=false;\r\n        EM.emit(EM.type.RESUME_ACTOR);\r\n        this._fsm.resumeSubState();\r\n    }\r\n});\r\n\r\n\r\n//变小\r\nvar ToSmall=cc.Class({\r\n    extends:State,\r\n    onEnter(){\r\n        this.target.animation.play(\"to_small\");    \r\n        this.target.animation.on(\"finished\",this.aniFinished,this);\r\n        this.target.isPause=true;\r\n        EM.emit(EM.type.PAUSE_ACTOR);\r\n        this._fsm.switchSubState(\"flash_catch_monster\");\r\n        EM.emit(EM.type.CHANGE_STATE,FORM_STATE.SMALL);\r\n    },\r\n    aniFinished(){\r\n        this.target.setFormState(FORM_STATE.SMALL);\r\n        this._fsm.switchPreState();\r\n    },\r\n    onExit(){\r\n        this.target.animation.off(\"finished\",this.aniFinished,this);\r\n        this.target.isPause=false;\r\n        EM.emit(EM.type.RESUME_ACTOR);\r\n    }\r\n});\r\n\r\n//die\r\nvar Die=cc.Class({\r\n    extends:State,\r\n    onEnter(){\r\n        this._fsm.clearSubState();\r\n        this.target.behind.stopAllActions();\r\n        this.target.node.stopAllActions();\r\n        this.target.enableInput=false;\r\n        this.target.enableCollsi=false;\r\n        this.target.isDie=true;\r\n        this.target.setPlayerState(PLAYER_STATE.DIE);\r\n        this.target.node.zIndex=100;\r\n        this.playAni();\r\n        this.target.node.y+=20;\r\n        this.target.hCurrAcceleration=0;\r\n        this.target.hCurrSpeed=0;\r\n        let delay=cc.delayTime(0.4);\r\n        this.target.node.runAction(cc.sequence(delay,cc.callFunc(this.callback,this)));\r\n        EM.emit(EM.type.STOP_READTIME);\r\n        EM.emit(EM.type.CHANGE_STATE,FORM_STATE.SMALL);\r\n    },\r\n    playAni(){\r\n        switch(this.target.getFormState()){\r\n            case FORM_STATE.SMALL:\r\n            case FORM_STATE.BIG:this.target.animation.play(\"small_die\");break;\r\n            case FORM_STATE.FIRE:this.target.animation.play(\"fire_die\");break;\r\n            default:break;\r\n        }\r\n    },\r\n    callback(){\r\n        this.target.vCurrAcceleration=-1400;\r\n        this.target.vCurrSpeed=500;\r\n    }\r\n});\r\n\r\n\r\n//Climb\r\nvar Climb=cc.Class({\r\n    extends:State,\r\n    onEnter(){\r\n        this.target.setPlayerState(PLAYER_STATE.CLIMB);\r\n        this.playAni();\r\n        this.target.hCurrAcceleration=0;\r\n        this.target.hCurrSpeed=0;\r\n        this.target.vCurrAcceleration=0;\r\n        this.target.isOnLand=false;\r\n        this.target.vCurrSpeed=this.getVSpeed();\r\n        \r\n    },\r\n    playAni(){\r\n        let name=\"\";\r\n        switch(this.target.getFormState()){\r\n            case FORM_STATE.SMALL:name=\"small_climb\";break;\r\n            case FORM_STATE.BIG:name=\"big_climb\";break;\r\n            case FORM_STATE.FIRE:name=\"fire_climb\";break;\r\n        } \r\n        this.target.animation.play(name);\r\n        this.target.animation.setCurrentTime(0.1);\r\n        this.target.animation.pause(name);\r\n    },\r\n    handleInput(input){\r\n        //按下a向左走\r\n        if(input.keyCode===cc.macro.KEY.a){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isAPressed){\r\n                    this.target.isAPressed=true;\r\n                    //this.target.setDir(DIR.DIR_LEFT);\r\n                    this.keyAPressed();\r\n                    return;\r\n                }\r\n            }else{\r\n                this.target.isAPressed=false;\r\n            }\r\n        }\r\n\r\n        //按下d向右走\r\n        if(input.keyCode===cc.macro.KEY.d){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isDPressed){\r\n                    this.target.isDPressed=true;\r\n                    //this.target.setDir(DIR.DIR_RIGHT);\r\n                    this.keyDPressed();\r\n                    return;\r\n                }\r\n            }else{\r\n                this.target.isDPressed=false;\r\n            }\r\n        }\r\n\r\n        //s\r\n        if(input.keyCode===cc.macro.KEY.s){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isSPressed){\r\n                    this.target.isSPressed=true;  \r\n                    if(!this.target.isTouchLand)this.resumeAni();\r\n                }\r\n            }else{\r\n                this.target.isSPressed=false;\r\n                this.pauseAni();\r\n            }\r\n            this.target.vCurrSpeed=this.getVSpeed();\r\n        }\r\n\r\n        //w\r\n        if(input.keyCode===cc.macro.KEY.w){\r\n            if(input.type===\"keydown\"){\r\n                if(!this.target.isWPressed){\r\n                    this.target.isWPressed=true;\r\n                    if(!this.target.isTouchLand)this.resumeAni();\r\n                }\r\n            }else{\r\n                this.target.isWPressed=false;\r\n                this.pauseAni();\r\n            }\r\n            this.target.vCurrSpeed=this.getVSpeed();\r\n        }\r\n    },\r\n    keyAPressed(){\r\n        let size=this.target.getSize();\r\n        if(!this.target.isDPressed){\r\n            if(this.target.dir===DIR.DIR_LEFT){\r\n                this.target.turnRight();\r\n                this.target.node.x-=20;\r\n            }else{\r\n                this.target.turnLeft();\r\n                this.target.node.x-=20;\r\n                this.target.hCurrSpeed=-50;\r\n                this.target.isOnCirrus=false;\r\n                this.target.isTouchLand?this.target.fsm.switchState(\"walk\"):this.target.fsm.switchState(\"fall\");\r\n            }\r\n        }\r\n    },\r\n    keyDPressed(){\r\n        let size=this.target.getSize();\r\n        if(!this.target.isAPressed){\r\n            if(this.target.dir===DIR.DIR_RIGHT){\r\n                this.target.turnLeft();\r\n                this.target.node.x+=20;\r\n                gm.fixOffset(this.target.node.position);\r\n            }else{\r\n                this.target.turnRight();\r\n                this.target.node.x+=20;\r\n                this.target.hCurrSpeed=50;\r\n                this.target.isOnCirrus=false;\r\n                this.target.isTouchLand?this.target.fsm.switchState(\"walk\"):this.target.fsm.switchState(\"fall\");\r\n            }\r\n        }\r\n    },   \r\n    pauseAni(){\r\n        this.target.animation.pause();\r\n    },\r\n    resumeAni(){\r\n        this.target.animation.resume();\r\n    },\r\n    update(dt){\r\n        //触底停掉动画\r\n        if(this.target.isTouchLand){\r\n            this.target.isTouchLand=false;\r\n            this.pauseAni();\r\n        }\r\n    },\r\n    getVSpeed(){\r\n        if(this.target.isSPressed){\r\n            return this.target.isCollsiFlag?-250:-120;\r\n        }else if(this.target.isWPressed){\r\n            return 120;\r\n        }else{\r\n            return 0;\r\n        }\r\n    }   \r\n});\r\n\r\nmodule.exports={Stand,Jump,Walk,Slide,Squat,Fire,Fall,Swim,Float,FlashCatchStar,FlashCatchFlower,FlashCatchMonster,ToBig,ToSmall,Die,Climb};\r\n"]}