{"version":3,"sources":["effects.js"],"names":["cc","Class","extends","Component","properties","pieces","Prefab","coin","score","onLoad","EM","on","type","PIECES_EFFECT","piecesEffect","COIN_EFFECT","coinEffect","SCORE_EFFECT","scoreEffect","LIFE_EFFECT","lifeEffect","start","pos","gid","instantiate","node","addChild","x","y","script","getComponent","init","emit","ADD_COIN","moveUp","moveBy","v2","easing","easeCubicActionOut","moveDown","easeCubicActionIn","runAction","sequence","callFunc","target","data","bind","removeSelf","ADD_SCORE","scor","label","Label","string","fadeOut","onDestroy","off"],"mappings":"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","file":"effects.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n        pieces:cc.Prefab,\r\n        coin:cc.Prefab,\r\n        score:cc.Prefab\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n\r\n        EM.on(EM.type.PIECES_EFFECT,this.piecesEffect,this);\r\n        EM.on(EM.type.COIN_EFFECT,this.coinEffect,this);\r\n        EM.on(EM.type.SCORE_EFFECT,this.scoreEffect,this);\r\n        EM.on(EM.type.LIFE_EFFECT,this.lifeEffect,this);\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    piecesEffect(pos,gid){\r\n        let pieces=cc.instantiate(this.pieces);\r\n        this.node.addChild(pieces);\r\n        pieces.x=pos.x;\r\n        pieces.y=pos.y;\r\n        let script=pieces.getComponent(\"wall_effect\");\r\n        script.init(gid);\r\n    },\r\n    coinEffect(pos,score){\r\n        EM.emit(EM.type.ADD_COIN,1);\r\n\r\n        let coin=cc.instantiate(this.coin);\r\n        this.node.addChild(coin);\r\n        coin.x=pos.x;\r\n        coin.y=pos.y;\r\n\r\n        let moveUp=cc.moveBy(0.25,cc.v2(0,80)).easing(cc.easeCubicActionOut());\r\n        let moveDown=cc.moveBy(0.25,cc.v2(0,-80)).easing(cc.easeCubicActionIn());\r\n        coin.runAction(cc.sequence(moveUp,moveDown,cc.callFunc(function(target,data){\r\n            this.scoreEffect(data.pos,data.score);\r\n        }.bind(this),this,{pos:pos,score:score}),cc.removeSelf()));\r\n    },\r\n    scoreEffect(pos,score){\r\n        EM.emit(EM.type.ADD_SCORE,score);\r\n        let scor=cc.instantiate(this.score);\r\n        this.node.addChild(scor);\r\n        let label=scor.getComponent(cc.Label);\r\n        scor.x=pos.x;\r\n        scor.y=pos.y;\r\n        label.string=score;\r\n        \r\n        let moveUp=cc.moveBy(0.5,cc.v2(0,60));\r\n        let fadeOut=cc.fadeOut(0.5);\r\n        scor.runAction(cc.sequence(moveUp,fadeOut,cc.removeSelf()));\r\n    },\r\n    lifeEffect(pos){\r\n        let scor=cc.instantiate(this.score);\r\n        this.node.addChild(scor);\r\n        let label=scor.getComponent(cc.Label);\r\n        scor.x=pos.x;\r\n        scor.y=pos.y;\r\n        label.string=\"1 UP\";\r\n        \r\n        let moveUp=cc.moveBy(0.5,cc.v2(0,60));\r\n        let fadeOut=cc.fadeOut(0.5);\r\n        scor.runAction(cc.sequence(moveUp,fadeOut,cc.removeSelf()));\r\n    },\r\n    onDestroy(){\r\n        EM.off(EM.type.PIECES_EFFECT);\r\n        EM.off(EM.type.COIN_EFFECT);\r\n        EM.off(EM.type.SCORE_EFFECT);\r\n        EM.off(EM.type.LIFE_EFFECT);\r\n    }\r\n    //update (dt) {},\r\n\r\n});\r\n"]}