{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\prop/assets\\script\\prop\\ladder.js"],"names":["Actor","require","cc","Class","extends","properties","big","Prefab","mid","small","white","init","currSkin","actorType","arguments","moveType","currLadder","backPos","skinType","isOnLadder","ENUM","LADDER_TYPE","SMALL","MID","BIG","WHITE","generateLadder","ladder","LADDER_MOVE_TYPE","MV","instantiate","node","addChild","moveUp","moveBy","v2","easing","easeCubicActionInOut","moveDown","runAction","repeatForever","sequence","MH","moveRight","moveLeft","RUP","rUp","schedule","RDOWN","rDown","STOP","setPosition","interactive","actor","gm","playerScript","sizeOne","getSize","oldLocalPos","oldPos","x","width","y","playerBox","rect","height","children","value","box","getBoundingBox","ladderBox","Intersection","rectRect","headPos","contains","isUpOrDown","vCurrSpeed","isOnLand","position","vCurrAcceleration","hCurrSpeed","collsiWithPlayerBullet","bullet","isDie","onCollsiWithPBullet","isOutScreen","pos","convertToWorldSpace","global","winSize","update","dt","move","removeFromParent","child","i","length","getPlayerState","PLAYER_STATE","JUMP","currPlayer","fsm","switchState"],"mappings":"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","file":"ladder.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\prop","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\nvar Actor=require(\"actor\");\r\ncc.Class({\r\n    extends:Actor,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n        big:cc.Prefab,\r\n        mid:cc.Prefab,\r\n        small:cc.Prefab,\r\n        white:cc.Prefab\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n    init(){\r\n        this.currSkin=null;\r\n        this.actorType=arguments[0];\r\n        this.moveType=arguments[2];\r\n        this.currLadder=null;\r\n        this.backPos=null;\r\n        this.skinType=arguments[1];\r\n        this.isOnLadder=false;\r\n\r\n        switch(this.skinType){\r\n            case ENUM.LADDER_TYPE.SMALL:\r\n                this.currSkin=this.small;\r\n            break;\r\n            case ENUM.LADDER_TYPE.MID:\r\n                this.currSkin=this.mid;\r\n            break;\r\n            case ENUM.LADDER_TYPE.BIG:\r\n                this.currSkin=this.big;\r\n            break;\r\n            case ENUM.LADDER_TYPE.WHITE:\r\n                this.currSkin=this.white;\r\n            break;   \r\n        }\r\n\r\n        this.generateLadder();\r\n    },\r\n    generateLadder(){\r\n        let ladder=null;\r\n        switch(this.moveType){\r\n            case ENUM.LADDER_MOVE_TYPE.MV:\r\n                ladder=cc.instantiate(this.currSkin);\r\n                this.node.addChild(ladder);\r\n                let moveUp=cc.moveBy(4,cc.v2(0,320)).easing(cc.easeCubicActionInOut());\r\n                let moveDown=cc.moveBy(4,cc.v2(0,-320)).easing(cc.easeCubicActionInOut());\r\n                this.node.runAction(cc.repeatForever(cc.sequence(moveUp,moveDown)));\r\n            break;\r\n            case ENUM.LADDER_MOVE_TYPE.MH:\r\n                ladder=cc.instantiate(this.currSkin);\r\n                this.node.addChild(ladder);\r\n                let moveRight=cc.moveBy(3,cc.v2(240,0)).easing(cc.easeCubicActionInOut());\r\n                let moveLeft=cc.moveBy(3,cc.v2(-240,0)).easing(cc.easeCubicActionInOut());\r\n                this.node.runAction(cc.repeatForever(cc.sequence(moveRight,moveLeft)));\r\n            break;\r\n            case ENUM.LADDER_MOVE_TYPE.RUP:\r\n                this.rUp();\r\n                this.schedule(this.rUp,3);\r\n            break;\r\n            case ENUM.LADDER_MOVE_TYPE.RDOWN:\r\n                this.rDown();\r\n                this.schedule(this.rDown,3);\r\n            break;\r\n            case ENUM.LADDER_MOVE_TYPE.STOP:\r\n                ladder=cc.instantiate(this.currSkin);\r\n                this.node.addChild(ladder);\r\n            break;\r\n            default:\r\n                ladder=cc.instantiate(this.currSkin);\r\n                this.node.addChild(ladder);\r\n            break;\r\n        }\r\n    },\r\n    rUp(){\r\n        let ladder=cc.instantiate(this.currSkin);\r\n        let moveUp=cc.moveBy(1,cc.v2(0,120));\r\n        this.node.addChild(ladder);\r\n        ladder.setPosition(cc.v2(0,-40));\r\n        ladder.runAction(cc.repeatForever(moveUp));\r\n    },\r\n    rDown(){\r\n        let ladder=cc.instantiate(this.currSkin);\r\n        let moveDown=cc.moveBy(1,cc.v2(0,-120));\r\n        this.node.addChild(ladder);\r\n        ladder.setPosition(cc.v2(0,40));\r\n        ladder.runAction(cc.repeatForever(moveDown));\r\n    },\r\n    interactive(actor){\r\n        if(gm.playerScript.isOnLadder)return;\r\n        let sizeOne=actor.getSize();\r\n        let oldLocalPos=cc.v2(actor.oldPos.x-sizeOne.width/2,actor.oldPos.y);\r\n        let playerBox=cc.rect(sizeOne.x-sizeOne.width/2,sizeOne.y,sizeOne.width,sizeOne.height);\r\n        for(let value of this.node.children){\r\n            let box=value.getBoundingBox();\r\n            let ladderBox=cc.rect(box.x+this.node.x,box.y+this.node.y,box.width,box.height);\r\n            if(cc.Intersection.rectRect(playerBox,ladderBox)){\r\n                \r\n                //向上碰撞\r\n                let headPos=cc.v2(playerBox.x+playerBox.width/2,playerBox.y+playerBox.height);\r\n                if(ladderBox.contains(headPos)&&actor.isUpOrDown()){\r\n                    actor.vCurrSpeed=-50;\r\n                    actor.node.y=ladderBox.y-sizeOne.height-1;\r\n                    return;\r\n                }\r\n\r\n                //向下碰撞\r\n                if(playerBox.y<ladderBox.y+ladderBox.height&&playerBox.y>ladderBox.y\r\n                    &&((playerBox.x>ladderBox.x&&playerBox.x<ladderBox.x+ladderBox.width)\r\n                     ||(playerBox.x+sizeOne.width>ladderBox.x&&playerBox.x+sizeOne.width<ladderBox.x+ladderBox.width))&&!actor.isUpOrDown()){\r\n    \r\n                        actor.node.y=ladderBox.y+ladderBox.height+6;\r\n                        actor.isOnLand=true;\r\n                        actor.isOnLadder=true;\r\n                        this.isOnLadder=true;\r\n                        this.currLadder=value;\r\n                        this.backPos=this.node.position;\r\n\r\n                        //碰到静止状态的云梯\r\n                        if(this.moveType===ENUM.LADDER_MOVE_TYPE.STOP){\r\n                            this.vCurrAcceleration=-1000;\r\n                        }\r\n\r\n                        //碰到天空云梯\r\n                        if(this.skinType===ENUM.LADDER_TYPE.WHITE){\r\n                            this.hCurrSpeed=150;\r\n                        }\r\n\r\n                        return;\r\n                }\r\n\r\n                // //左//右\r\n                if(actor.node.x>this.node.x){\r\n                    actor.node.x=ladderBox.x+ladderBox.width+sizeOne.width/2;\r\n                    actor.hCurrSpeed=0;\r\n                }else{\r\n                    actor.node.x=ladderBox.x-sizeOne.width/2;\r\n                    actor.hCurrSpeed=0;\r\n                }\r\n                return;\r\n            }\r\n        }\r\n        \r\n    },\r\n    collsiWithPlayerBullet(bullet){\r\n        if(this.isDie||bullet.isDie)return;\r\n        let sizeOne=bullet.getSize();\r\n\r\n    },\r\n    onCollsiWithPBullet(bullet){\r\n    \r\n    },\r\n    isOutScreen(){\r\n        let pos=this.node.convertToWorldSpace(cc.v2(0,0));\r\n        if(pos.x>global.winSize.width*2||pos.x<-40*6||pos.y<-40*5||pos.y>global.winSize.height+40*5){\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    update (dt) {\r\n        \r\n        this.move(dt);\r\n\r\n        if(this.isOutScreen()){\r\n            this.node.removeFromParent();\r\n        }\r\n\r\n        //移除屏幕之外的ladder\r\n        let child=this.node.children;\r\n        for(let i=0;i<child.length;i++){\r\n            if(child[i].y<-40*16||child[i].y>global.winSize.height){\r\n                child[i].removeFromParent();\r\n                i--;\r\n            }\r\n        }\r\n\r\n\r\n        //云梯带着人物移动\r\n        if(this.isOnLadder&&gm.playerScript.getPlayerState()!=PLAYER_STATE.JUMP){\r\n            //垂直方向的移动\r\n            let box=this.currLadder.getBoundingBox();\r\n            let ladderBox=cc.rect(box.x+this.node.x,box.y+this.node.y,box.width,box.height);\r\n            gm.currPlayer.y=ladderBox.y+box.height;\r\n\r\n            //水平方向的移动\r\n            if(this.moveType===ENUM.LADDER_MOVE_TYPE.MH&&this.backPos){\r\n                gm.currPlayer.x+=this.node.x-this.backPos.x;\r\n                this.backPos=this.node.position;\r\n            }\r\n        }\r\n\r\n        //检测人物是否在云梯上\r\n        if(this.isOnLadder){\r\n            if(gm.playerScript.getPlayerState()===PLAYER_STATE.JUMP){\r\n                gm.playerScript.isOnLadder=false;\r\n                this.isOnLadder=false;\r\n                this.vCurrAcceleration=0;\r\n                this.vCurrSpeed=0;\r\n            }else{\r\n                let sizeOne=gm.playerScript.getSize();\r\n                let playerBox=cc.rect(sizeOne.x-sizeOne.width/2,sizeOne.y,sizeOne.width,sizeOne.height);\r\n                let box=this.currLadder.getBoundingBox();\r\n                let ladderBox=cc.rect(box.x+this.node.x,box.y+this.node.y,box.width,box.height);\r\n                if(playerBox.x<ladderBox.x-playerBox.width||playerBox.x>ladderBox.x+ladderBox.width){\r\n                    gm.playerScript.isOnLadder=false;\r\n                    this.isOnLadder=false;\r\n                    gm.playerScript.fsm.switchState(\"fall\");\r\n                    this.vCurrAcceleration=0;\r\n                    this.vCurrSpeed=0;\r\n                }\r\n            }\r\n        }\r\n\r\n        \r\n    },\r\n    getSize(){\r\n        return cc.rect(this.node.x,this.node.y,0,0);\r\n    }\r\n});\r\n"]}